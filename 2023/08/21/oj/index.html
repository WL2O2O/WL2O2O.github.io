<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-1CX1BM2TTD"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1CX1BM2TTD")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-MP1THLPZFC"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MP1THLPZFC")</script><meta name="google-site-verification" content="COwq4mOphzRDivHncvzFed0dZge2jK1Rz_yDgTJsoQY"><meta name="baidu-site-verification" content="codeva-CjBrQqVd18"><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.ico"><link rel="icon" href="/img/fluid.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#21252b"><meta name="author" content="WLei224"><meta name="keywords" content=""><meta name="description" content="Smart OJ 复习一下项目开发流程 项目简介、项目调研、项目需求分析  核心业务流程  项目功能模块  技术选型  项目初始化  项目开发  测试  优化 （代码提交、代码审核、产品验收）  上线   在此过程中，也是要不断写文档、持续调研、沉淀知识的  项目简介OJ ： Online Judge（在线判题评测系统） 用户可以选择题目练习，在线编写代码，测试代码，提交代码，系统会根据设置好的答"><meta property="og:type" content="article"><meta property="og:title" content="基于Spring Boot的在线编程判题系统"><meta property="og:url" content="https://wlei224.gitee.io/2023/08/21/oj/index.html"><meta property="og:site_name" content="主页 | CSGUIDER&#39;S Blog"><meta property="og:description" content="Smart OJ 复习一下项目开发流程 项目简介、项目调研、项目需求分析  核心业务流程  项目功能模块  技术选型  项目初始化  项目开发  测试  优化 （代码提交、代码审核、产品验收）  上线   在此过程中，也是要不断写文档、持续调研、沉淀知识的  项目简介OJ ： Online Judge（在线判题评测系统） 用户可以选择题目练习，在线编写代码，测试代码，提交代码，系统会根据设置好的答"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202311151627634.png"><meta property="article:published_time" content="2023-08-21T00:12:32.000Z"><meta property="article:modified_time" content="2023-12-19T01:45:16.838Z"><meta property="article:author" content="WLei224"><meta property="article:tag" content="Spring Boot"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202311151627634.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>基于Spring Boot的在线编程判题系统 - 主页 | CSGUIDER&#39;S Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"wlei224.gitee.io",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"left",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"956b14594152e1b71ce14695a71235d5",google:"G-MP1THLPZFC",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>if(!Fluid.ctx.dnt){var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?956b14594152e1b71ce14695a71235d5";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",(function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-MP1THLPZFC","auto"),ga("send","pageview")}))</script><meta name="generator" content="Hexo 5.4.2"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>CS_GUIDER</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>Home</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>Archives</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>Categories</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>Tags</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>About</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>Links</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search" style="font-size:1.1em">Search</i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li><li class="nav-item" id="github-btn"><a class="nav-link" target="_blank" aria-label="Github" href="https://github.com/WL2O2O/WL2O2O.github.io" title="If you get gains, star achieves you and me✨"><i class="iconfont icon-github-fill" id="icon-github-fill" style="font-size:1.1em"></i></a></li><li class="nav-item" id="high-btn"><a class="nav-link" target="_self" aria-label="High" onclick="runHighEffect()"><i>High一下!</i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202311151640352.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="基于Spring Boot的在线编程判题系统"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> WLei224 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-08-21 08:12" pubdate>August 21, 2023 am</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 11k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 89 mins </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> views</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="padding-left:2rem;margin-right:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">基于Spring Boot的在线编程判题系统</h1><p class="note note-info">Last updated on December 19, 2023 am<br><button onclick='window.location.href="https://github.com/WL2O2O/WL2O2O.github.io/edit/hexoBlog/source/_posts/oj.md"' target="_blank" class="rounded-link">编辑文章✒️</button></p><style>.note{display:flex;flex-direction:column}.rounded-link{border-radius:10px;padding:4px;text-align:center;text-decoration:none;position:relative;width:100%;margin-left:auto;margin-right:10px}</style><p></p><div class="markdown-body"><h1 id="Smart-OJ"><a href="#Smart-OJ" class="headerlink" title="Smart OJ"></a>Smart OJ</h1><blockquote><h2 id="复习一下项目开发流程"><a href="#复习一下项目开发流程" class="headerlink" title="复习一下项目开发流程"></a>复习一下项目开发流程</h2><ol><li><p>项目简介、项目调研、项目需求分析</p></li><li><p>核心业务流程</p></li><li><p>项目功能模块</p></li><li><p>技术选型</p></li><li><p>项目初始化</p></li><li><p>项目开发</p></li><li><p>测试</p></li><li><p>优化</p><p>（代码提交、代码审核、产品验收）</p></li><li><p>上线</p></li></ol><p>在此过程中，也是要不断写文档、持续调研、沉淀知识的</p></blockquote><h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><p>OJ ： Online Judge（在线判题评测系统）</p><p>用户可以选择题目练习，在线编写代码，测试代码，提交代码，系统会根据设置好的答案对用户提交的代码进行评测，给出评测结果！</p><h4 id="项目亮点"><a href="#项目亮点" class="headerlink" title="项目亮点"></a>项目亮点</h4><ol><li>项目新颖，重复度低，写简历有区分度</li><li>区别于常见的<code>CRUD</code>项目，偏向于架构设计、编程思想之类的知识</li><li>项目复杂度高，可扩展性强</li></ol><h4 id="OJ系统的常用概念"><a href="#OJ系统的常用概念" class="headerlink" title="OJ系统的常用概念"></a>OJ系统的常用概念</h4><p>ac 表示你的题目通过，结果正确<br>题目限制：时间限制、内存限制<br>题目介绍<br>题目输入<br>题目输出<br>题目输入用例<br>题目输出用例</p><h4 id="难点-判题系统"><a href="#难点-判题系统" class="headerlink" title="难点:判题系统"></a><strong>难点</strong>:判题系统</h4><p>普通测评：管理员设置题目的输入和输出用例，比如我输入 A，你要输出 B 才是正确的；交给判题机去执行用户的代码，给用户的代码喂输入用例，比如 A，看用户程序的执行结果是否和标准答案的输出一致。<br>（比对用例文件）</p><p>特殊测评（SPJ）：管理员设置题目的输入和输出，比如我输入 1，用户的答案只要是 &gt; 0 或 &lt; 2 都是正确的；特判程序，不是通过对比用例文件是否一致这种死板的程序来检验，而是要专门根据这道题目写一个特殊的判断程序，程序接收题目的输入（1）、标准输出用例（2）、用户的结果（1.5） ，特判程序根据这些值来比较是否正确。</p><p>交互测评：让用户输入一个例子，就给一个输出结果，交互比较灵活，没办法通过简单的、死板的输入输出文件来搞定</p><p><em><strong>不能让用户随便引入包、随便遍历、暴力破解，需要使用正确的算法。 =&gt; 安全性</strong></em></p><p><em><strong>判题过程是异步的 =&gt; 异步化</strong></em></p><p><em><strong>提交之后，会生成一个提交记录，有运行的结果以及运行信息（时间限制、内存限制）</strong></em></p><h2 id="项目调研"><a href="#项目调研" class="headerlink" title="项目调研"></a>项目调研</h2><p><a target="_blank" rel="noopener" href="https://github.com/HimitZH/HOJ(%E9%80%82%E5%90%88%E5%AD%A6%E4%B9%A0)">https://github.com/HimitZH/HOJ(适合学习)</a><br><a target="_blank" rel="noopener" href="https://github.com/QingdaoU/OnlineJudge(python,%E4%B8%8D%E5%A5%BD%E5%AD%A6%EF%BC%8C%E5%BE%88%E6%88%90%E7%86%9F)">https://github.com/QingdaoU/OnlineJudge(python,不好学，很成熟)</a><br><a target="_blank" rel="noopener" href="https://github.com/hzxie/Noj(%E6%98%9F%E6%98%9F%E6%B2%A1%E9%82%A3%E4%B9%88%E5%A4%9A%EF%BC%8C%E6%B2%A1%E9%82%A3%E4%B9%88%E6%88%90%E7%86%9F%EF%BC%8C%E4%BD%86%E7%9B%B8%E5%AF%B9%E5%A5%BD%E5%AD%A6)">https://github.com/hzxie/Noj(星星没那么多，没那么成熟，但相对好学)</a><br><a target="_blank" rel="noopener" href="https://github.com/vfleaking,/uoj(php%E5%AE%9E%E7%8E%B0%E7%9A%84)">https://github.com/vfleaking,/uoj(php实现的)</a></p><h2 id="项目需求分析"><a href="#项目需求分析" class="headerlink" title="项目需求分析"></a>项目需求分析</h2><h4 id="实现核心"><a href="#实现核心" class="headerlink" title="实现核心"></a>实现核心</h4><ol><li><p>权限校验</p></li><li><p>代码沙箱（安全沙箱 – 防止代码藏毒）</p><p>代码安全：设置安全的、隔离的沙箱，以确保用户的代码不会影响到系统的安全</p></li><li><p>判题规则</p><p>题目用例的比对，结果的验证</p></li><li><p>任务调度</p><p>资源分配：防止用户疯狂占用资源，措施：异步化处理，服务资源有限，按照用户提交顺序进行判题</p></li></ol><h4 id="核心业务流程"><a href="#核心业务流程" class="headerlink" title="核心业务流程"></a>核心业务流程</h4><p><img src="https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202311221849444.png" srcset="/img/loading.gif" lazyload alt="image-20231122184857284"></p><p>时序图：</p><p><img src="https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202311151640352.png" srcset="/img/loading.gif" lazyload alt="image-20231115164047376"></p><h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><ol><li><p>题目模块</p><p>a. 管理员：创建、删除、修改</p><p>b. 用户：搜索题目</p><p>c. 在线做题、提交题目代码</p></li><li><p>用户模块</p><p>a. 注册与登录</p></li><li><p>判题模块</p><p>a. 提交判题（结果是否正确与错误）</p><p>b. 错误处理（内存溢出、安全性、超时）</p><p>c. 自主实现代码沙箱（安全、隔离的一个环境）</p><p>d. 开放接口</p></li></ol><h4 id="扩展思路"><a href="#扩展思路" class="headerlink" title="扩展思路"></a>扩展思路</h4><ol><li>支持多种语言</li><li>远程评测</li><li>完善的评测功能：普通评测、特殊评测、交互评测、在线自测、文件IO</li><li>统计分析判题记录</li><li>权限校验</li></ol><h2 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h2><h4 id="前端："><a href="#前端：" class="headerlink" title="前端："></a>前端：</h4><p><code>Vue3、手撸Umi项目模板、AcroDesign组件库、在线代码编辑器、在线文档浏览</code></p><h4 id="后端："><a href="#后端：" class="headerlink" title="后端："></a>后端：</h4><p><code>Java进程控制、Java安全管理、部分JVM知识点、虚拟机、Docker、Spring Cloud微服务、消息队列</code></p><h2 id="架构设计"><a href="#架构设计" class="headerlink" title="架构设计"></a>架构设计</h2><p>采用分层架构：用户层、接入层、业务层、服务层、存储层、资源层</p><p><img src="E:/Master/TyporaImages/oj/image-20231122192355366.png" srcset="/img/loading.gif" lazyload alt="image-20231122192355366"></p><h2 id="项目排期"><a href="#项目排期" class="headerlink" title="项目排期"></a>项目排期</h2><ol><li>项目简介、项目调研、需求分析、技术选型、架构设计、现有<code>OJ</code>主流实现方案</li><li>前后端项目初始化、前端通用项目模板的搭建</li><li>主业务流程的前后端开发（争取把代码沙箱之外的全部搞定）</li><li>专攻代码沙箱（自主实现，不止一种实现方案，层层递进，通过实战用例来进行安全优化）</li><li>系统优化（微服务改造、系统扩展思路）</li></ol><h2 id="主流OJ实现方案"><a href="#主流OJ实现方案" class="headerlink" title="主流OJ实现方案"></a>主流OJ实现方案</h2><ol><li>用现成的<code>OJ</code>系统</li></ol><p>网上有很多开源的<code>OJ</code>项目，比如<code>青岛OJ</code>、<code>HustOJ</code>等，可以直接下载开源代码自己部署。</p><p>比较推荐的是<code>judge0</code>，这是一个非常成熟的<code>商业OJ</code>项目，支持 60 多种编程语言！</p><blockquote><p>代码：<a target="_blank" rel="noopener" href="https://github.com/judge0/judge0">https://github.com/judge0/judge0</a></p></blockquote><ol start="2"><li>用现成的服务</li></ol><p>如果你不希望完整部署一套大而全的代码，只是想复用他人已经实现的、最复杂的判题逻辑，那么可以直接使用现成的 判题<code>API</code>、或者现成的 代码沙箱 等服务。</p><p>比如<code>judge0</code>提供的<code>判题API</code>，非常方便易用。只需要通过 HTTP 调用<code>submissions</code>判题接口，把用户的代码、输入值、预期的执行结果作为请求参数发送给<code>judge0</code>的服务器，它就能自动帮你编译执行程序，并且返回程序的运行结果。</p><p><code>API</code>的作用：接受代码、返回执行结果</p><blockquote><p><code>Judge0 API</code>地址：<a target="_blank" rel="noopener" href="https://rapidapi.com/judge0-official/api/judge0-ce">https://rapidapi.com/judge0-official/api/judge0-ce</a></p><p>官方文档：<a target="_blank" rel="noopener" href="https://ce.judge0.com/#submissions-submission-post">https://ce.judge0.com/#submissions-submission-post</a></p></blockquote><blockquote><p>流程</p><p>1先注册</p><p>2再开通订阅</p><p>3然后测试 language 接口</p><p>4测试执行代码接口 submissions</p></blockquote><ol start="3"><li><strong>自主开发</strong>✨✨✨–我的方案</li></ol><p>自主实现判题服务和代码沙箱，适合学习，但不适用于商业项目。</p><ol start="4"><li>把 AI 来当做代码沙箱</li></ol><p>现在 AI 的能力已经十分强大了，我们可以把各种本来很复杂的功能直接交给 AI 来实现。</p><p>只要脑洞够大，AI + 编程 = 无限的可能~</p><ol start="5"><li>移花接木</li></ol><p>这种方式最有意思、也最 “缺德”。很多同学估计想不到。</p><p>那就是可以通过让程序来操作模拟浏览器的方式，用别人已经开发好的 OJ 系统来帮咱们判题。</p><p>比如使用 Puppeteer + 无头浏览器，把咱们系统用户提交的代码，像人一样输入到别人的 OJ 网页中，让程序点击提交按钮，并且等别人的 OJ 系统返回判题结果后，再把这个结果返回给我们自己的用户。</p><p>这种方式的缺点就是把核心流程交给了别人，如果别人服务挂了，你的服务也就挂了；而且别人 OJ 系统不支持的题目，可能你也支持不了。</p><h1 id="后端项目笔记"><a href="#后端项目笔记" class="headerlink" title="后端项目笔记"></a>后端项目笔记</h1><h2 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h2><h3 id="五步走："><a href="#五步走：" class="headerlink" title="五步走："></a>五步走：</h3><ol><li>选中项目全局搜索替换springboot-init为新项目名</li><li>选中包，全局更改替换包名springbootinit</li><li>更改包名</li><li>本地新建数据库，直接执行sql/create table.sql脚本，修改库名为yuoj,执行即可</li><li>改application.yml配置，修改MySQL数据库的连接库名、账号密码，端口号</li></ol><h3 id="初始化模板待完善的地方："><a href="#初始化模板待完善的地方：" class="headerlink" title="初始化模板待完善的地方："></a>初始化模板待完善的地方：</h3><ol><li>日志：根据错误类型分类，分级归档</li><li>扩展：引入分布式锁、多线程、线程池</li></ol><h2 id="项目模板复习"><a href="#项目模板复习" class="headerlink" title="项目模板复习"></a>项目模板复习</h2><p><strong>1)先阅读README.md</strong></p><p><strong>2)sql/create table.sql定义了数据库的初始化建库建表语句</strong></p><p><strong>3)sql/post_es mapping,json帖子表在ES中的建表语句</strong></p><p><strong>4)aop:用于全局权限校验、全局日志记录</strong></p><p><strong>5)common:万用的类，比如通用响应类</strong></p><p><strong>6)config:用于接收application.yml中的参数，初始化一些客户端的配置类（比如对象存储客户端）</strong></p><p><strong>7)constant:定义常量</strong></p><p><strong>8)controller:接受请求</strong></p><p><strong>9)esdao:类似mybatis的mapper,用于操作ES</strong></p><p><strong>10)exception:异常处理相关</strong></p><p><strong>11)job:任务相关（定时任务、单次任务）</strong></p><p><strong>12)manager:服务层（一般是定义一些公用的服务、对接第三方APl等）</strong></p><p><strong>13)mapper:mybatis的数据访问层，用于操作数据库</strong></p><p><strong>14)model:数据模型、实体类、包装类、枚举值</strong></p><p><strong>15)service:服务层，用于编写业务逻辑</strong></p><p><strong>16)utils:工具类，各种各样公用的方法</strong></p><p><strong>17)wxmp:公众号相关的包</strong></p><p><strong>18)test:单元测试</strong></p><p><strong>19)MainApplication:项目启动入口</strong></p><p><strong>20)Dockerfile:用于构建Docker镜像</strong></p><h2 id="基本开发流程"><a href="#基本开发流程" class="headerlink" title="基本开发流程"></a>基本开发流程</h2><h3 id="库表设计"><a href="#库表设计" class="headerlink" title="库表设计"></a>库表设计</h3><ol><li><p>根据功能设计库表</p></li><li><ol><li>用户表</li></ol></li></ol><p>字段：id、账号、密码、昵称、头像、简介、用户角色、微信开放平台id、公众号openId、创建时间、修改时间、是否删除（项目全局配置文件中已经配置了 MybatisPlus isDelete 字段为逻辑删除）</p><ol><li><ol><li>题目表</li></ol></li></ol><p>字段：</p><p>题目相关：id、标题、内容、标签、答案、提交数量、通过数量、通关率（扩展）；</p><p>判题相关：判题用例（judgeCase / json）、判题限制（judgeConfig / json）、判题类型（扩展）；</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs prolog">[  &#123;    <span class="hljs-string">&quot;input&quot;</span>: <span class="hljs-string">&quot;1 2&quot;</span>,    <span class="hljs-string">&quot;output&quot;</span>: <span class="hljs-string">&quot;3 4&quot;</span>  &#125;,  &#123;    <span class="hljs-string">&quot;input&quot;</span>: <span class="hljs-string">&quot;1 3&quot;</span>,    <span class="hljs-string">&quot;output&quot;</span>: <span class="hljs-string">&quot;2 4&quot;</span>  &#125; ]<span class="hljs-string">``</span>&#123;  <span class="hljs-string">&quot;timeLimit&quot;</span>: <span class="hljs-number">1000</span>,  <span class="hljs-string">&quot;memoryLimit&quot;</span>: <span class="hljs-number">1000</span>,  <span class="hljs-string">&quot;stackLimit&quot;</span>: <span class="hljs-number">1000</span> &#125;<br></code></pre></td></tr></table></figure><ol><li><ol><li>用户-题目提交表</li></ol></li></ol><p>字段：用户id、题目id、语言、代码、判题状态、判题信息（judgeInfo / json）;</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;  <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;&#123;$ 判题信息枚举值 $&#125;&quot;</span>,  <span class="hljs-string">&quot;time&quot;</span>: <span class="hljs-number">1000</span>, <span class="hljs-regexp">//</span> 单位：ms  <span class="hljs-string">&quot;memory&quot;</span>: <span class="hljs-number">1000</span>  <span class="hljs-regexp">//</span> 单位：kb &#125;<br></code></pre></td></tr></table></figure><p>枚举值信息：</p><ul><li><ul><li><ul><li><ul><li>ACCEPT 通过</li><li>WRONG_ANSWER 答案错误</li><li>COMPILE_ERROR 编译错误</li><li>MEMORY_LIMIT_EXCEEDED 内存溢出</li><li>TIME_LIMIT_EXCEETED 超时</li><li>PRESENTATION_ERROR 展示错误</li><li>OUTPUT_LIMIT_EXCEEDED 输出溢出</li><li>WAITING 等待中</li><li>DANGEROUS_OPERATION 危险操作</li><li>RUNTIME_ERROR 运行错误</li><li>SYSTEM_ERROR 系统错误</li></ul></li></ul></li></ul></li></ul><p>数据库表字段存 json 的<strong>前提：</strong></p><p>首先，字段含义相关，属于同一类；</p><p>其次，不需要根据 json 中的某一字段进行查询；</p><p>最后，字段存储不用占用太多空间。</p><p>存 json 的<strong>好处：</strong></p><p>便于扩展，即：不用修改库表结构，就可以直接操作对象内部的字段</p><p>小知识（数据库索引）：</p><p>什么时候适合加索引？如何给某个字段加上索引？</p><p>首先，索引需要建立在有区分度的字段上；</p><p>其次，需要从我们的实际业务出发，无论是单个索引，还是联合索引，都需要从实际的查询语句、字段枚举值的区分度、字段的类型考虑，特别是 where 条件指定的字段。</p><p>例如：where userId = 1 and questionId = 2，这个时候就可以分别建立索引，或者是联合索引，<strong>如果是数据量不大的话，尽量不用索引，因为索引也需要占用空间。（待考证！！！）</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 数据库初始化<br># <span class="hljs-variable">@author</span> <span class="hljs-operator">&lt;</span>a href<span class="hljs-operator">=</span>&quot;https://github.com/wl2o2o&quot;<span class="hljs-operator">&gt;</span>程序员CSGUIDER<span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>a<span class="hljs-operator">&gt;</span><br># <span class="hljs-variable">@from</span> <span class="hljs-operator">&lt;</span>a href<span class="hljs-operator">=</span>&quot;https://wl2o2o.github.io&quot;<span class="hljs-operator">&gt;</span>CSGUIDER博客<span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>a<span class="hljs-operator">&gt;</span><br><br><span class="hljs-comment">-- 创建库</span><br><span class="hljs-keyword">create</span> database if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> smartoj;<br><br><span class="hljs-comment">-- 切换库</span><br>use smartoj;<br><br><span class="hljs-comment">-- 用户表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> <span class="hljs-keyword">user</span> (<br>  id        	     <span class="hljs-type">bigint</span>           auto_increment                        		comment <span class="hljs-string">&#x27;id&#x27;</span>   	             <span class="hljs-keyword">primary</span> key,<br>  userAccount      <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)  															  <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>  		comment <span class="hljs-string">&#x27;用户账号&#x27;</span>,<br>  userPassword     <span class="hljs-type">varchar</span>(<span class="hljs-number">512</span>)						          						<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;用户密码&#x27;</span>,<br>  userName 		     <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)  								 							 			<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;用户昵称&#x27;</span>,<br>  userAvatar 	     <span class="hljs-type">varchar</span>(<span class="hljs-number">1024</span>) 								  									<span class="hljs-keyword">null</span> 	   	comment <span class="hljs-string">&#x27;用户头像&#x27;</span>,<br>  userProfile      <span class="hljs-type">varchar</span>(<span class="hljs-number">512</span>)							 	  										<span class="hljs-keyword">null</span>      comment <span class="hljs-string">&#x27;用户简介&#x27;</span>,<br>  userRole 	 	     <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)     <span class="hljs-keyword">default</span> <span class="hljs-string">&#x27;user&#x27;</span>			  			<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;用户角色&#x27;</span>,<br>  unionId			 		 <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)								  										<span class="hljs-keyword">null</span>		  comment <span class="hljs-string">&#x27;微信开放平台id&#x27;</span>,<br>  mpOpenId 		     <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)					   										   		<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;微信公众号id&#x27;</span>,<br>  createTime	     datetime         <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>	  	comment <span class="hljs-string">&#x27;创建时间&#x27;</span>,<br>  updateTime       datetime         <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	<span class="hljs-keyword">on</span> <span class="hljs-keyword">update</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> comment <span class="hljs-string">&#x27;更新时间&#x27;</span>,<br>  isDelete         tinyint          <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>					  				<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>  	  comment <span class="hljs-string">&#x27;逻辑删除&#x27;</span>,<br>  index 			 		 idx_unionId      (unionId)<br>) comment <span class="hljs-string">&#x27;用户表&#x27;</span>  <span class="hljs-keyword">collate</span> <span class="hljs-operator">=</span> utf8mb4_unicode_ci;<br><br><br># 字段：<br># 题目相关：id、标题、内容、标签、答案、提交数量、通过数量、通关率（扩展）；<br># 判题相关：判题用例（judgeCase <span class="hljs-operator">/</span> json）、判题限制（judgeConfig <span class="hljs-operator">/</span> json）、判题类型（扩展）；<br><span class="hljs-comment">-- 题目表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> question (<br>  id        	     <span class="hljs-type">bigint</span>      	  auto_increment                         			comment <span class="hljs-string">&#x27;题目id&#x27;</span>              <span class="hljs-keyword">primary</span> key,<br>  userId        	 <span class="hljs-type">bigint</span>        															 	<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;创建用户id&#x27;</span>,<br>  title			    	 <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)  								 								<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;题目标题&#x27;</span>,<br>  tags 			     	 <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>)				    		 	 								<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;题目标签&#x27;</span>,<br>  content          text							        									  <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;题目内容&#x27;</span>,<br>  answer	 	  	   text				  						 												<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;题目答案&#x27;</span>,<br>  judgeCase	 	     text 								     	 									<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;判题用例&#x27;</span>,<br>  judgeConfig	     text									     												<span class="hljs-keyword">null</span>			comment <span class="hljs-string">&#x27;判题限制&#x27;</span>,<br>  submitNum 	     <span class="hljs-type">int</span> 					  <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>					 								<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;提交数量&#x27;</span>,<br>  acceptNum        <span class="hljs-type">int</span>         	  <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>	 			  	 							<span class="hljs-keyword">null</span>      comment <span class="hljs-string">&#x27;通过数量&#x27;</span>,<br>  thumbNum 		     <span class="hljs-type">int</span>			  		<span class="hljs-keyword">default</span> <span class="hljs-number">0</span>												 	<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;点赞数量&#x27;</span>,<br>  favourNum		     <span class="hljs-type">int</span> 	   		  	<span class="hljs-keyword">default</span> <span class="hljs-number">0</span>					 								<span class="hljs-keyword">null</span> 	    comment <span class="hljs-string">&#x27;收藏数量&#x27;</span>,<br>  createTime	     datetime       <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>  		<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>	 		comment <span class="hljs-string">&#x27;创建时间&#x27;</span>,<br>  updateTime       datetime       <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> 		<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>   		<span class="hljs-keyword">on</span> <span class="hljs-keyword">update</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>  comment <span class="hljs-string">&#x27;更新时间&#x27;</span>,<br>  isDelete         tinyint        <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>                 		<span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>    	comment <span class="hljs-string">&#x27;逻辑删除&#x27;</span>,<br>  index 			 		 idx_userId     (userId)<br>) comment <span class="hljs-string">&#x27;题目表&#x27;</span>  <span class="hljs-keyword">collate</span> <span class="hljs-operator">=</span> utf8mb4_unicode_ci;<br><br><br># 字段：用户id、题目id、语言、代码、判题状态、判题信息（judgeInfo <span class="hljs-operator">/</span> json）;<br><span class="hljs-comment">-- 题目提交表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> question_submit (<br>  id                <span class="hljs-type">bigint</span>          auto_increment                           comment <span class="hljs-string">&#x27;id&#x27;</span>		<span class="hljs-keyword">primary</span> key,<br>  userId            <span class="hljs-type">bigint</span>                                      <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;创建用户 id&#x27;</span>,<br>  questionId        <span class="hljs-type">bigint</span>                                      <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;题目 id&#x27;</span>,<br>  <span class="hljs-keyword">language</span>          <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)                                <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;编程语言&#x27;</span>,<br>  code              text                                        <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;用户代码&#x27;</span>,<br>  status            <span class="hljs-type">int</span>             <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>                   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;判题状态（0 - 待判题、1 - 判题中、2 - 成功、3 - 失败）&#x27;</span>,<br>  judgeInfo         text                                        		<span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;判题信息（json 对象）&#x27;</span>,<br>  createTime        datetime        <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;创建时间&#x27;</span>,<br>  updateTime        datetime        <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     <span class="hljs-keyword">on</span> <span class="hljs-keyword">update</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> comment <span class="hljs-string">&#x27;更新时间&#x27;</span>,<br>  isDelete          tinyint         <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>                   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>     comment <span class="hljs-string">&#x27;是否删除&#x27;</span>,<br>  index             idx_questionId  (questionId),<br>  index             idx_userId      (userId)<br><br>) comment <span class="hljs-string">&#x27;题目提交表&#x27;</span>  <span class="hljs-keyword">collate</span> <span class="hljs-operator">=</span> utf8mb4_unicode_ci;<br></code></pre></td></tr></table></figure><h3 id="代码生成方法"><a href="#代码生成方法" class="headerlink" title="代码生成方法"></a>代码生成方法</h3><ol><li>使用 MyBatisX 插件，会自动根据库表字段，一键生成业务的基础 CRUD 代码</li><li>编写 Controller 层代码（根据模板进行复用，复制逻辑相同代码，替换字段）</li><li>编写 DTO、VO、枚举值字段，用于接受前端请求或者业务间传递信息。（复用项目模板）</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.yupi.yuoj.model.enums;<br><br><span class="hljs-keyword">import</span> org.apache.commons.lang3.ObjectUtils;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 题目提交编程语言枚举</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> &lt;a href=&quot;https://github.com/liyupi&quot;&gt;程序员鱼皮&lt;/a&gt;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@from</span> &lt;a href=&quot;https://yupi.icu&quot;&gt;编程导航知识星球&lt;/a&gt;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">QuestionSubmitLanguageEnum</span> &#123;<br><br>    JAVA(<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;java&quot;</span>),<br>    CPLUSPLUS(<span class="hljs-string">&quot;c++&quot;</span>, <span class="hljs-string">&quot;c++&quot;</span>),<br>    GOLANG(<span class="hljs-string">&quot;golang&quot;</span>, <span class="hljs-string">&quot;golang&quot;</span>);<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String text;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String value;<br><br>    QuestionSubmitLanguageEnum(String text, String value) &#123;<br>        <span class="hljs-built_in">this</span>.text = text;<br>        <span class="hljs-built_in">this</span>.value = value;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取值列表</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title function_">getValues</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Arrays.stream(values()).map(item -&gt; item.value).collect(Collectors.toList());<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据 value 获取枚举</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> value</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> QuestionSubmitLanguageEnum <span class="hljs-title function_">getEnumByValue</span><span class="hljs-params">(String value)</span> &#123;<br>        <span class="hljs-keyword">if</span> (ObjectUtils.isEmpty(value)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (QuestionSubmitLanguageEnum anEnum : QuestionSubmitLanguageEnum.values()) &#123;<br>            <span class="hljs-keyword">if</span> (anEnum.value.equals(value)) &#123;<br>                <span class="hljs-keyword">return</span> anEnum;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> value;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getText</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> text;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>编写一些独立的类，因为以上库表中设计的含有 JSON 字段，为了方便处理 JSON 中的某个字段。</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 题目用例</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JudgeCase</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 输入用例</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String input;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 输出用例</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String output;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>校验 Controller 类，解决报错</li><li>编写 Service 代码，完成业务逻辑</li></ol><p><strong>小知识：</strong></p><p><strong>为什么要加上业务前缀（上述代码中的JudgeCase），什么时候不加？</strong></p><p>首先，增加业务前缀有利于增加区分度，防止多表中重复类名产生冲突；</p><p>其次，通常情况下，我们希望抽出一个公用类来共享，这时不需加业务前缀。</p><p><strong>什么是 VO 类？有什么用？</strong></p><p>VO：View Object（显示层对象）—— 专门给前端返回、显示的对象，一般会过滤脱敏掉一些不需要返回给前端的字段，保证安全性，不仅更加方便展示给用户，而且方便展示给前端开发者，还可以节约网络传输大小。</p><p>DTO：Data Transfer Object（数据传输对象）</p><p>BO：Bussiness Object（业务对象）</p><p><strong>怎么防止爬虫爬取题目？有什么简单的方法？</strong></p><p>建议把题目的 id 生成规则 改为 ASSIGN_ID ，这样就可以通过其底层的雪花算法：ASSIGN_UUID 随机生成一个 32 位的 id，有效避免爬虫对题目的爬取。</p><p>示例：</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-operator">/**</span> <span class="hljs-operator">*</span> <span class="hljs-built_in">id</span> <span class="hljs-operator">*/</span> <span class="hljs-operator">@</span>TableId(<span class="hljs-keyword">type</span> <span class="hljs-operator">=</span> IdType.ASSIGN_ID) <span class="hljs-keyword">private</span> Long <span class="hljs-built_in">id</span>;<br></code></pre></td></tr></table></figure><h3 id="查询提交信息接口（网站的提交信息实时监控面板）"><a href="#查询提交信息接口（网站的提交信息实时监控面板）" class="headerlink" title="查询提交信息接口（网站的提交信息实时监控面板）"></a>查询提交信息接口（网站的提交信息实时监控面板）</h3><ul><li><p>功能：</p></li><li><ul><li>根据用户 ID 查询</li><li>题目 ID 查询</li><li>编程语言查询</li><li>题目状态查询</li></ul></li><li><p>注意事项：</p></li><li><ul><li>非管理员和本人，不得观看其他用户的代码</li></ul></li><li><p>实现方案：</p></li><li><ul><li>查询 ==&gt; 根据权限脱敏</li><li></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@Override public QuestionSubmitVO getQuestionSubmitVO(<span class="hljs-params">QuestionSubmit questionSubmit, User loginUser</span>) &#123;    QuestionSubmitVO questionSubmitVO = QuestionSubmitVO.objToVo(<span class="hljs-params">questionSubmit</span>);    // 脱敏：仅本人和管理员能看见自己（提交 userId 和登录用户 id 不同）提交的代码    long userId = loginUser.getId();    // 处理脱敏    if (<span class="hljs-params">userId != questionSubmit.getUserId(<span class="hljs-params"></span>) &amp;&amp; !userService.isAdmin(<span class="hljs-params">loginUser</span>)</span>) &#123;        questionSubmitVO.setCode(<span class="hljs-params">null</span>);    &#125;    return questionSubmitVO; &#125;</span><br></code></pre></td></tr></table></figure><p><em><strong>todo: 熟悉快速 CRUD 的步骤，过项目模板，充分理解；完善更加通用的 Controller、Service 代码。</strong></em></p><h2 id="代码沙箱开发"><a href="#代码沙箱开发" class="headerlink" title="代码沙箱开发"></a>代码沙箱开发</h2><p>为了提高代码沙箱的通用性（便于后期进行扩展 AI 判题或者远程判题），</p><p>我们定义代码沙箱为接口，这样就便于后期进行扩展了⭐⭐⭐⭐⭐</p><ol><li>定义代码沙箱为接口，提高通用性</li></ol><p>这样，我们之后的项目判题模块代码只调用代码沙箱的接口进行判题，不用调用实现类，</p><p>这样就可以不用更改代码了（之更改调用的接口）</p><p>TODO: 代码沙箱的请求接口中，判题的 timeLimit 可以不加，也或者自行扩展（扩展点）</p><p>扩展思路：增加一个代码沙箱状态的接口</p><ol><li>定义所种不通风的代码沙箱的实现</li></ol><p>示例代码沙箱——打通流程</p><p>远程代码沙箱——调用实际的接口</p><p>第三方代码沙箱——调用网上现成的代码沙箱（例如：goJudge）</p><p>完成示例代码沙箱 —&gt; 改为远程代码沙箱</p><h2 id="判题服务完整业务流程开发"><a href="#判题服务完整业务流程开发" class="headerlink" title="判题服务完整业务流程开发"></a>判题服务完整业务流程开发</h2><p><strong>判题服务业务流程：</strong></p><ol><li>传入题目的 id ，获取到对应的题目、提交信息（包含代码、编程语言等）</li><li>调用沙箱，获取执行结果</li><li>根据执行结果，判断 –&gt; 设置题目判题状态与信息</li></ol><p>以上是最基本的判题业务流程，但是还不够完整，存在点击多次、多次判题的 Bug，那么就要给判题设置一个状态了！</p><p><strong>完善后的判题服务业务流程：</strong></p><ol><li>传入题目的 id ，获取到对应的题目、提交信息（包含代码、编程语言等）</li><li><strong>if （判题状态不为等待中） 抛出异常;</strong></li><li><strong>更改判题状态为判题中</strong></li><li>调用沙箱，获取执行结果</li><li>根据代码沙箱执行结果，判断运行结果是否则正确 –&gt; 设置题目最终的判题状态与信息</li></ol><p><strong>判断逻辑：</strong></p><ol><li>先判断，代码沙箱执行的结果输出数量是否和预期输出数量是否一致</li><li>依次判断每一项的预期输出是否相等</li><li>判题题目的限制是否符合要求</li><li>其他异常</li></ol><p>注意：</p><p>如果我们的代码沙箱执行程序需要十秒钟，这个时间可能根据编程语言的不同而该变动，那么怎么解决？</p><p>A：我们可以采取策略模式，针对不同的情况，定义不同的策略</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Project/" class="category-chain-item">Project</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Spring-Boot/">#Spring Boot</a> <a href="/tags/MySQL/">#MySQL</a></div></div><div class="license-box my-3"><div class="license-title"><div>基于Spring Boot的在线编程判题系统</div><div>https://wlei224.gitee.io/2023/08/21/oj/</div></div><div class="license-meta"><div class="license-meta-item"><div>Author</div><div>WLei224</div></div><div class="license-meta-item license-meta-date"><div>Posted on</div><div>August 21, 2023</div></div><div class="license-meta-item license-meta-date"><div>Updated on</div><div>December 19, 2023</div></div><div class="license-meta-item"><div>Licensed under</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div></div><article id="comments" lazyload><div id="giscus" class="giscus"></div><script type="text/javascript">Fluid.utils.loadComments("#giscus",(function(){var t={repo:"WL2O2O/CS_GUIDER_Giscus","repo-id":"R_kgDOJYdTQw",category:"Announcements","category-id":"DIC_kwDOJYdTQ84CWKC6","theme-light":"light","theme-dark":"dark",mapping:"pathname","reactions-enabled":1,"emit-metadata":0,"input-position":"top",lang:"zh-CN"},e={};for(let i in t){if(!i.startsWith("theme-"))e[i.startsWith("data-")?i:"data-"+i]=t[i]}window.GiscusThemeLight="light",window.GiscusThemeDark="dark",e["data-theme"]="dark"===document.documentElement.getAttribute("data-user-color-scheme")?"dark":"light";for(let t in e){var i=e[t];null!=i&&""!==i||delete e[t]}var n=document.createElement("script");n.setAttribute("src","https://giscus.app/client.js"),n.setAttribute("crossorigin","anonymous");for(let t in e)n.setAttribute(t,e[t]);var a=document.getElementsByTagName("script"),r=a.length>0?a[a.length-1]:document.head||document.documentElement;r.parentNode.insertBefore(n,r.nextSibling)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/WL2O2O" target="_blank" rel="nofollow noopener"><span>WL2O2O</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">Views: <span id="busuanzi_value_site_pv"></span> </span><span id="busuanzi_container_site_uv" style="display:none">Visitors: <span id="busuanzi_value_site_uv"></span></span></div><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?956b14594152e1b71ce14695a71235d5";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?532b21a5fc88ac9d57905860111efbbb";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/high.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>