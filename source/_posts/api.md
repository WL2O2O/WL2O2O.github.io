---
title: APIå¼€æ”¾å¹³å°
tags:
  - Ant Design Pro
  - React
  - Ant Design Pro Components
  - Umi
  - Umi Request
  - Spring Boot
  - SDKå¼€å‘
categories:
  - Project
excerpt: >-
  é¡¹ç›®ä»‹ç»ï¼šå‰ç«¯å¼€å‘çš„æ—¶å€™æœ‰æœ‰æ—¶ä¼šéœ€è¦åç«¯çš„æ¥å£ï¼Œå¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ª API æ¥å£å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ— éœ€åç«¯æ¥å£äº†ã€‚æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªæä¾› API
  æ¥å£è°ƒç”¨çš„å¹³å°ï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œä¸ç™»å½•ï¼Œå¼€é€šæ¥å£çš„è°ƒç”¨æƒé™ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¥å£ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šè¿›è¡Œæ¬¡æ•°ç»Ÿè®¡ã€‚ç®¡ç†é™¢å¯ä»¥å‘å¸ƒæ¥å£ã€ä¸‹çº¿æ¥å£ã€æ¥å…¥æ¥å£ï¼Œä»¥åŠå¯è§†åŒ–æ¥å£çš„è°ƒç”¨æƒ…å†µã€‚
abbrlink: c40430e5
date: 2023-06-03 12:34:12
---

# APIå¼€æ”¾å¹³å°

> å†™åœ¨æœ€å‰é¢ï¼š
>
> â€‹	å­¦åˆ°çš„çŸ¥è¯†ä¸æ”¶åˆ°çš„å»ºè®®ï¼š
>
> 	1. æŠŠè‡ªå·±æ‰€æœ‰çš„æ•°æ®åº“å»ºè¡¨è¯­å¥æ€»ç»“åˆ°ä¸€èµ·ï¼Œåç»­æœ‰ç”¨ï¼›
> 	1. è®°å½•Bugæ–‡æ¡£
> 	1. å¤šè®°å½•ä¸€äº›éœ€æ±‚çš„è§£å†³æ–¹æ¡ˆã€æé«˜è‡ªå·±çš„æ¶æ„èƒ½åŠ›

## é¡¹ç›®ä»‹ç»

> å‰ç«¯å¼€å‘çš„æ—¶å€™æœ‰æœ‰æ—¶ä¼šéœ€è¦åç«¯çš„æ¥å£ï¼Œå¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ªAPIæ¥å£å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ— éœ€åç«¯å€Ÿå£äº†

ä¸€ä¸ªæä¾›APIæ¥å£è°ƒç”¨çš„å¹³å°ï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œä¸ç™»å½•ï¼Œå¼€é€šæ¥å£çš„è°ƒç”¨æƒé™ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¥å£ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šè¿›è¡Œæ¬¡æ•°ç»Ÿè®¡ã€‚ç®¡ç†é™¢å¯ä»¥å‘å¸ƒæ¥å£ã€ä¸‹çº¿æ¥å£ã€æ¥å…¥æ¥å£ï¼Œä»¥åŠå¯è§†åŒ–æ¥å£çš„è°ƒç”¨æƒ…å†µã€‚



ä¸€ä¸ªAPIæ¥å£å¹³å°ï¼š

1. é˜²æ­¢æ”»å‡»
2. ä½¿ç”¨é™åˆ¶
3. ç»Ÿè®¡è°ƒç”¨æ¬¡æ•°
4. è®¡è´¹
5. æµé‡ä¿æŠ¤
6. APIæ¥å…¥

## é¢„è®¡å®Œæˆæ—¶é—´

5-6å‘¨

## ä¸šåŠ¡æµç¨‹

å‰å°ã€SDKã€APIç½‘å…³ã€æ¨¡æ‹Ÿæ¥å£ã€åå°    å…±äº”ä¸ªå­æ¨¡å—

**éš¾ç‚¹**ï¼šæ€æƒ³

## æŠ€æœ¯é€‰å‹

* å‰ç«¯
  * Ant Design Pro
  * React
  * Ant Design Pro Components
  * Umi
  * Umi Requestï¼ˆAxiosçš„å°è£…ï¼‰--è¯·æ±‚åº“ï¼ˆå‰åç«¯è”è°ƒï¼‰
* åç«¯
  * Spring Boot
  * Spring Boot Staterï¼ˆSDKå¼€å‘ï¼‰--å¯ä»¥å‘å¸ƒåˆ°mavenä»“åº“----**ç®€å†äº®ç‚¹**
  * ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼ˆç½‘å…³ã€é™æµã€æ—¥å¿—å®ç°ï¼‰

## é¡¹ç›®è®¡åˆ’

### Day01--é¡¹ç›®åˆå§‹åŒ–

é¡¹ç›®ä»‹ç»ã€è®¾è®¡ã€æŠ€æœ¯é€‰å‹

åŸºç¡€é¡¹ç›®çš„æ­å»º

æ¥å£ç®¡ç†

ç”¨æˆ·æŸ¥çœ‹æ¥å£çš„æƒé™



### Day02--æ¥å£è°ƒç”¨

1. ç»§ç»­å¼€å‘æ¥å£ç®¡ç†å‰ç«¯é¡µé¢ 15min
2. å¼€å‘æ¨¡æ‹ŸAPIæ¥å£ 5min
3. å¼€å‘è°ƒç”¨æ¥å£çš„ä»£ç  10-20min
4. ä¿è¯è°ƒç”¨çš„å®‰å…¨æ€§ï¼ˆAPIç­¾åè®¤è¯ï¼‰ 15min
5. å®¢æˆ·ç«¯SDKçš„å¼€å‘ 15min
6. ç®¡ç†å‘˜æ¥å£çš„å‘å¸ƒä¸è°ƒç”¨ 15min
7. æ¥å£æ–‡æ¡£çš„å±•ç¤ºã€æ¥å£åœ¨çº¿è°ƒç”¨ 15min



### Day03--æ¥å£è®¡è´¹ä¸ä¿æŠ¤

ç»Ÿè®¡ç”¨æˆ·è°ƒç”¨æ¬¡æ•°

é™æµ

è®¡è´¹

æ—¥å¿—

å¼€é€š

### Day04--ç®¡ç†å‘˜ç»Ÿè®¡åˆ†æ

æä¾›å¯è§†åŒ–å¹³å°ï¼Œå±•ç¤ºæ‰€æœ‰æ¥å£çš„è°ƒç”¨æƒ…å†µï¼Œä¾¿äºç®¡ç†ä»·æ ¼

æ¥å£é¢„è­¦





## Day01 éœ€æ±‚åˆ†æ

1. ç®¡ç†å‘˜å¯ä»¥å¯¹æ¥å£ä¿¡æ¯è¿›è¡Œå¢åˆ æ”¹æŸ¥

2. ç”¨æˆ·å¯ä»¥è®¿é—®å‰å°ï¼ŒæŸ¥çœ‹æ¥å£ä¿¡æ¯

### ä»Šæ—¥è®¡åˆ’

1. é¡¹ç›®è„šæ‰‹æ¶æ­å»ºï¼ˆåˆå§‹åŒ–é¡¹ç›®ï¼‰10åˆ†é’Ÿå‰ç«¯ã€5-10åˆ†é’Ÿåç«¯ 
1. ç®¡ç†å‘˜å¯ä»¥å¯¹æ¥å£ä¿¡æ¯è¿›è¡Œå¢åˆ æ”¹æŸ¥
1. ç”¨æˆ·å¯ä»¥è®¿é—®å‰å°ï¼ŒæŸ¥çœ‹æ¥å£çš„ä¿¡æ¯









### é¡¹ç›®åˆå§‹åŒ–ï¼ˆå‰åç«¯ï¼‰

* ### å‰ç«¯

1. ä½¿ç”¨Ant Design Proæä¾›çš„`pro-cli`æ¥å¿«é€Ÿçš„åˆå§‹åŒ–è„šæ‰‹æ¶ã€‚

   ```bash
   # æŸ¥çœ‹nodeå’Œnpmç‰ˆæœ¬
   å»ºè®®16å’Œ8
   # ä½¿ç”¨ npm
   npm i @ant-design/pro-cli -g
   pro create myapi-frontend
   # ä¸‹è½½é¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–
   yarn
   æ­¤æ—¶å¯èƒ½ä¼šé‡åˆ°nodeç‰ˆæœ¬è¦æ±‚çš„é—®é¢˜ï¼Œå› ä¸ºç‰ˆæœ¬æ›´æ–°è¿­ä»£çš„åŸå› ï¼Œæˆ‘å½“æ—¶è¦æ±‚çš„æ˜¯ä½¿ç”¨16.14.0çš„nodeç‰ˆæœ¬ï¼Œ
   å¦‚æœæ„Ÿè§‰åˆ‡æ¢nodeç‰ˆæœ¬éº»çƒ¦çš„è¯ï¼Œè¿™é‡Œæ¨èä½¿ç”¨nvmï¼ˆnodeçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼‰ï¼Œä½¿ç”¨æ–¹æ³•è‡ªè¡Œç™¾åº¦
   ```

2. é¡¹ç›®ç˜¦èº«

	é‡åˆ°äº†ä¸€ä¸ªå¤§å‘ï¼Œæ˜Ÿçƒçš„çƒå‹ä»¬ä¹Ÿéƒ½é‡åˆ°äº†ï¼Œä¸‹é¢æ˜¯çƒå‹çš„è§£å†³æ–¹æ³•ï¼Œäº²æµ‹æœ‰æ•ˆã€‚

   ```bash
   # å…³é—­ESLintä¸­ä¸Prettieré‡å¤çš„è§„åˆ™ï¼Œç¡®ä¿ä»£ç æ ¼å¼åŒ–çš„ä¸€è‡´æ€§
   yarn add eslint-config-prettier --dev
   # ç”¨äºæ£€æŸ¥å’Œä¿®å¤JavaScriptä»£ç ä¸­çš„å¸¸è§é—®é¢˜
   yarn add eslint-plugin-unicorn --dev
   ```
### é¡¹ç›®å»é™¤å›½é™…åŒ–å­˜åœ¨é—®é¢˜çš„è§£å†³æ–¹æ³•

![image-20230630231124235](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307010940465.png)

â€‹	jestè„šæœ¬å‘½ä»¤ä¸­æœ‰`jest`ä¸çŸ¥é“æ˜¯å¦éœ€è¦åˆ æ‰ï¼Œé±¼çš®çš„æ–‡ä»¶ä¸­æ²¡æœ‰å‡ºç°ï¼Œå¯èƒ½æ˜¯è·ŸæŸäº›ç‰ˆæœ¬æœ‰å…³ï¼Œå¥‡å¥‡å¦™å¦™ï¼Œè®°å½•ä¸€ä¸‹

![image-20230630233743871](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307010940466.png)

* ### åç«¯

3. åç«¯é¡¹ç›®åˆå§‹åŒ–

â€‹	ç›´æ¥ä½¿ç”¨é±¼æ€»æä¾›çš„ä¸‡èƒ½æ¨¡æ¿`springboot-init`,æ”¹æˆé¡¹ç›®çš„åå­—ï¼Œç„¶åå…¨å±€æœç´¢å…³é”®å­—è¿›è¡Œæ›¿æ¢

â€‹	è¿æ¥æ•°æ®åº“

â€‹	æµ‹è¯•è¿è¡Œ

4. æ•°æ®åº“åº“è¡¨è®¾è®¡

â€‹	**æ¥å£ä¿¡æ¯è¡¨**

```sql
# æ•°æ®åº“åˆå§‹åŒ–
# @author <a href="https://github.com/liyupi">ç¨‹åºå‘˜é±¼çš®</a>
# @from <a href="https://yupi.icu">ç¼–ç¨‹å¯¼èˆªçŸ¥è¯†æ˜Ÿçƒ</a>
-- åˆ›å»ºåº“
create database if not exists myapi;

-- åˆ‡æ¢åº“
use myapi;

-- ç”¨æˆ·è¡¨
create table if not exists user
(
    id           bigint auto_increment comment 'id' primary key,
    userName     varchar(256)                           null comment 'ç”¨æˆ·æ˜µç§°',
    userAccount  varchar(256)                           not null comment 'è´¦å·',
    userAvatar   varchar(1024)                          null comment 'ç”¨æˆ·å¤´åƒ',
    gender       tinyint                                null comment 'æ€§åˆ«',
    userRole     varchar(256) default 'user'            not null comment 'ç”¨æˆ·è§’è‰²ï¼šuser / admin',
    userPassword varchar(512)                           not null comment 'å¯†ç ',
    `accessKey` varchar(512) not null comment 'accessKey',
    `secretKey` varchar(512) not null comment 'secretKey',
    createTime   datetime     default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    updateTime   datetime     default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    isDelete     tinyint      default 0                 not null comment 'æ˜¯å¦åˆ é™¤',
    constraint uni_userAccount
        unique (userAccount)
) comment 'ç”¨æˆ·';

-- æ¥å£ä¿¡æ¯
create table if not exists myapi.`interface_info`
(
    `id` bigint not null auto_increment comment 'ä¸»é”®' primary key,
    `name` varchar(256) not null comment 'åç§°',
    `description` varchar(256) null comment 'æè¿°',
    `url` varchar(512) not null comment 'æ¥å£åœ°å€',
    `requestHeader` text null comment 'è¯·æ±‚å¤´',
    `responseHeader` text null comment 'å“åº”å¤´',
    `status` int default 0 not null comment 'æ¥å£çŠ¶æ€ï¼ˆ0-å…³é—­ï¼Œ1-å¼€å¯ï¼‰',
    `method` varchar(256) not null comment 'è¯·æ±‚ç±»å‹',
    `userId` bigint not null comment 'åˆ›å»ºäºº',
    `createTime` datetime default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    `updateTime` datetime default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    `isDelete` tinyint default 0 not null comment 'æ˜¯å¦åˆ é™¤(0-æœªåˆ , 1-å·²åˆ )'
) comment  'æ¥å£ä¿¡æ¯';

-- ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»è¡¨
create table if not exists myapi.`user_interface_info`
(
    `id` bigint not null auto_increment comment 'ä¸»é”®' primary key,
    `userId` bigint not null comment 'è°ƒç”¨ç”¨æˆ· id',
    `interfaceInfoId` bigint not null comment 'æ¥å£ id',
    `totalNum` int default 0 not null comment 'æ€»è°ƒç”¨æ¬¡æ•°',
    `leftNum` int default 0 not null comment 'å‰©ä½™è°ƒç”¨æ¬¡æ•°',
    `status` int default 0 not null comment '0-æ­£å¸¸ï¼Œ1-ç¦ç”¨',
    `createTime` datetime default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    `updateTime` datetime default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    `isDelete` tinyint default 0 not null comment 'æ˜¯å¦åˆ é™¤(0-æœªåˆ , 1-å·²åˆ )'
) comment 'ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»';

insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('è®¸æ“å®‡', 'è–›èªå¥', 'www.cary-king.net', 'æ½˜åšæ¶›', 'è°­èªå¥', 0, 'çŸ³ç‚«æ˜', 9500534531);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('é™†å¼˜æ–‡', 'ç™½å¿—å¼º', 'www.leslee-kuhn.net', 'æ½˜æ‡¿è½©', 'é©¬é¸¿æ¶›', 0, 'é™ˆå³»ç†™', 3982575846);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('æ¯›å»ºè¾‰', 'ç½—æ–‡', 'www.rosaria-kilback.io', 'å†¯å­é»˜', 'å½­å“²ç€š', 0, 'èµµè¿œèˆª', 121776355);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å½­é›¨æ³½', 'è”¡ç…œç¥º', 'www.norris-bergstrom.biz', 'è‘£æ€æº', 'ç”°æ™“åš', 0, 'æ½˜æ“å®‡', 740);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å‚…å¿—å¼º', 'é™ˆæ¢“æ™¨', 'www.jordan-reinger.com', 'é‡‘å¿—å¼º', 'ç†Šé”¦ç¨‹', 0, 'é‚“ç¿æ¸Š', 35542559);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å•é»æ˜•', 'å­”è¶Šå½¬', 'www.fe-okon.info', 'ä¸‡ä¼Ÿå®¸', 'æ—æ˜Šç„¶', 0, 'å­Ÿè£è½©', 1445);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å¤é›ªæ¾', 'è®¸å­éª', 'www.lashawna-legros.co', 'è”¡æ˜Šç„¶', 'èƒ¡é¹æ¶›', 0, 'é’Ÿç«‹è¾‰', 34075514);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('ä¸¥é’°è½©', 'é˜å¿—æ³½', 'www.kay-funk.biz', 'è«çš“è½©', 'éƒ­é»æ˜•', 0, 'é¾šå¤©å®‡', 70956);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('è§å˜‰æ‡¿', 'æ›¹ç† å½¤', 'www.margarette-lindgren.biz', 'ç”°æ³½æ´‹', 'é‚“ç¿æ¸Š', 0, 'æ¢å¿—å¼º', 98);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('æœé©°', 'å†¯æ€æº', 'www.vashti-auer.org', 'é»å¥æŸ', 'æ­¦åšæ–‡', 0, 'æä¼Ÿå®¸', 9);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å²é‡‘é‘«', 'è”¡é¹æ¶›', 'www.diann-keebler.org', 'å¾çƒ¨éœ–', 'é˜å»ºè¾‰', 0, 'æçƒ¨ä¼Ÿ', 125);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('æ—ç‚«æ˜', 'è´¾æ—­å°§', 'www.dotty-kuvalis.io', 'æ¢é›¨æ³½', 'é¾™ä¼Ÿæ³½', 0, 'è®¸æ™ºæ¸Š', 79998);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('ä½•é’°è½©', 'èµ–æ™ºå®¸', 'www.andy-adams.net', 'å´”æ€æ·¼', 'ç™½é¸¿ç…Š', 0, 'é‚µæŒ¯å®¶', 7167482751);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('é­å¿—å¼º', 'äºç«‹è¯š', 'www.ione-aufderhar.biz', 'æœ±æ‡¿è½©', 'ä¸‡æ™ºæ¸Š', 0, 'å”æ˜Šå¼º', 741098);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('ä¸¥å›æµ©', 'é‡‘èƒ¤ç¥¥', 'www.duane-boyle.org', 'é›·æ˜Šç„±', 'ä¾¯æ€èª', 0, 'éƒæ€', 580514);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å§šçš“è½©', 'é‡‘é¹', 'www.lyda-klein.biz', 'æœæ˜Šå¼º', 'é‚µå¿—æ³½', 0, 'å†¯é¸¿æ¶›', 6546);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å»–é©°', 'æ²ˆæ³½æ´‹', 'www.consuelo-sipes.info', 'å½­æ˜Šç„¶', 'é‚“è€€æ°', 0, 'å‘¨å½¬', 7761037);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('èµ–æ™ºæ¸Š', 'é‚“å¿—æ³½', 'www.emerson-mann.co', 'ç†Šæ˜å“²', 'è´ºå“²ç€š', 0, 'ç”°é¹', 381422);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('è®¸æ¶›', 'é™†è‡´è¿œ', 'www.vella-ankunding.name', 'è´¾å“²ç€š', 'è«æ˜Šç„±', 0, 'è¢è¶Šå½¬', 4218096);
insert into myapi.`interface_info` (`name`, `description`, `url`, `requestHeader`, `responseHeader`, `status`, `method`, `userId`) values ('å•å³»ç†™', 'æ²ˆé¹é£', 'www.shari-reichel.org', 'éƒ­é¸¿ç…Š', 'è¦ƒçƒ¨éœ–', 0, 'ç†Šé»æ˜•', 493);

```



> ç•™ä¸€ä¸ªå°bugï¼Œæ•°æ®åº“å»ºè¡¨è¯­å¥ç›´æ¥å¥—ç”¨çš„æœ€ç»ˆå»ºè¡¨è¯­å¥ï¼Œuserè¡¨ä¸­æ¶‰åŠåˆ°ä¸¤ä¸ªå…³äºkeyçš„å­—æ®µï¼Œæ‰‹åŠ¨æ”¹æˆäº†å¯ä»¥ä¸ºç©ºï¼Œè‹¥æœ‰é—®é¢˜ï¼Œåç»­å†åšå‡ºæ›´æ”¹

> åˆ©ç”¨`MyBatisX`æ’ä»¶ç”Ÿæˆæ¥å£ç®¡ç†çš„å¢åˆ æ”¹æŸ¥ä»£ç 

å°†ç”Ÿæˆçš„ä»£ç é€»è¾‘å¤åˆ¶åˆ°é¡¹ç›®çš„daoã€serviceã€mapperåŒ…é‡Œï¼Œ

ç„¶åè¿˜å‰©ä¸€ä¸ªcontrollerå±‚ï¼Œç›´æ¥å¤åˆ¶ä¸€ä»½æ¨¡æ¿ä¸­çš„controllerå±‚çš„ä»£ç ï¼Œè¿›è¡Œå¤ç”¨

æ³¨æ„æ­¤æ—¶æ¨¡ç³ŠæŸ¥è¯¢ä½¿ç”¨çš„å­—æ®µä¸æ˜¯contentï¼Œè€Œæ˜¯descriptionï¼Œè¿›è¡Œç›¸åº”çš„æ›´æ”¹ã€‚

æ­¤æ—¶ï¼Œå¢åˆ æ”¹æŸ¥æ“ä½œå·²å®Œæˆï¼Œå°±è¿™ä¹ˆç®€å• 

è·‘é€šåç«¯

* ### å‰ç«¯

ä½¿ç”¨oneapiæ’ä»¶è‡ªåŠ¨ç”Ÿæˆï¼ˆopenapiè§„èŒƒï¼‰

![image-20230701235258820](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307012353984.png)



> å…ˆå‰ï¼Œæˆ‘ä»¬ç™»é™†æ—¶æ˜¯é‡‡ç”¨çš„startå‡æ•°æ®è¿›è¡Œç™»å½•ï¼Œæ­¤æ—¶ä½¿ç”¨devï¼Œç™»é™†é¡µé¢æ˜¯å­˜åœ¨é—®é¢˜çš„ï¼Œå› ä¸ºè„šæ‰‹æ¶è‡ªåŠ¨ç”Ÿæˆçš„é¡µé¢ä¼šå¼ºåˆ¶è¦æ±‚ç™»å½•ï¼Œæ­¤æ—¶çš„ç™»å½•æ¥å£ä¸æˆ‘ä»¬oneapiè‡ªåŠ¨ç”Ÿæˆçš„æ¥å£å¯¹åº”ä¸ä¸Šï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œæ›´æ”¹Userã€‹ã€‹Loginã€‹ã€‹index.tsx
>

å› ä¸ºæ²¡æœ‰å¼€å‘æ³¨å†Œé¡µé¢ï¼Œå¯ä»¥ä»æ³¨å†Œä¸­å¿ƒé¡¹ç›®ä¸­å¤åˆ¶ä¸€ä¸ªè¿‡æ¥

ä¸ºäº†ä¾¿æ·çš„è¿›è¡Œå¼€å‘ï¼Œå…ˆä»swaggeræ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åç™»å½•å‘ç°æ²¡æœ‰è¿›è¡Œè·³è½¬ï¼Œé€šè¿‡åˆ†æå¾—å‡ºï¼Œæ˜¯å› ä¸ºå‰ç«¯æ²¡æœ‰è®°å½•ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œæ‰€ä»¥è¦è¿›ä¸€æ­¥è¿›è¡Œå®Œå–„ï¼Œåœ¨typings.d.tsä¸­è¿›è¡Œå®šä¹‰å…¨å±€ç™»å½•æ€



æ”¹é€ é¡µé¢ï¼Œå°†å‰ç«¯å±•ç¤ºçš„è¡¨æ ¼ï¼Œç”¨æ¥å±•ç¤ºè‡ªå·±çš„æ•°æ®





## Day02 æ¥å£è°ƒç”¨å¼€å‘ï¼ˆå‰ç«¯ï¼‰

> é¦–å…ˆå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨åç«¯swaggerè¿›è¡Œuserå¯†ç æ›´æ”¹çš„æ—¶å€™ï¼Œå¯†ç æ²¡æœ‰è¿›è¡ŒåŠ å¯†ï¼Œä¼šå¯¼è‡´å‰ç«¯è¿›è¡Œæ ¡éªŒçš„æ—¶å€™è¿”å›ç”¨æˆ·åæˆ–è€…å¯†ç ä¸æ­£ç¡®çš„ä¿¡æ¯

* ### ä¼˜åŒ–å‰ç«¯å±•ç¤ºé¡µé¢ï¼ˆæ”¹è·¯ç”±ï¼Œå…ˆä¸åˆ ï¼‰

  * ä¿æŒå‰åç«¯ç»„ä»¶åä¸€è‡´
  * ä¼˜åŒ–é¡µé¢ä»£ç 
  * é¦–é¡µæ²¡æœ‰é¡µé¢ï¼Œåç»­è¿›è¡Œå¼€å‘ä¸€ä¸ªéç®¡ç†å‘˜ç”¨æˆ·å¯ä»¥çœ‹åˆ°çš„é¡µé¢
  * è°ƒæ•´å¯¼èˆªæ çš„ä½ç½®ï¼Œå¯ä»¥å…ˆä½¿ç”¨antDesignProæ¡†æ¶æä¾›çš„åˆ‡æ¢å¯¼èˆªå¸ƒå±€å°è®¾ç½®
  
* ### æ–°å»ºæ¨¡æ€æ¡†çš„ç¼–å†™çœŸçš„å¾ˆæå¿ƒæ€ï¼Œæœ€åçš„åŸå› ç«Ÿç„¶æ˜¯å› ä¸ºä¸€ä¸ªå°çš„é”™è¯¯ï¼ˆé™ä¸‹å¿ƒæ¥ï¼‰ï¼ˆè¡€æ³ªæ•™è®­ï¼Œåšå®Œé¡¹ç›®è¿‡ä¸€éreactï¼‰

* ### å®Œå–„ä¿®æ”¹æ¡†

  * æ­¤å¤„è®¾è®¡åˆ°Reactçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œä¹Ÿæ˜¯é‡ä¸­ä¹‹é‡ï¼ˆuseEffectã€useRefï¼‰

  * ```tsx
    const formRef = useRef<ProFormInstance>();
    
    useEffect(() => {
      if(formRef){
        formRef.current?.setFieldsValue(values);
      } 
    }, [values])
    
    return (
        <Modal visible={visible} footer={null} onCancel={() => onCancel?.()}>
          <ProTable
            type="form"
            columns={columns}
            // å› ä¸ºè¿™é‡Œä½¿ç”¨çš„formç»„ä»¶ï¼Œåªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¼šé€ æˆç‚¹å‡»ä¿®æ”¹æŒ‰é’®è¿›è¡Œä¿®æ”¹çš„è¯ï¼Œæ•°æ®æ˜¯ä¸ä¼šå˜çš„
            // form={{
            //   initialValues: values
            // }}
            
            // æ‰€ä»¥æ­¤å¤„ç”¨åˆ°äº†ç›‘å¬
            formRef={formRef}
            
            onSubmit={async (value) => {
              onSubmit?.(value);
            }}
          />
        </Modal>
      );
    ```

  * > æ­¤å¤„æœ‰Bugï¼Œåç«¯æŠ¥ç©ºæŒ‡é’ˆ


* ### å®Œå–„åˆ é™¤æ¡†

  * ä»¿ç…§ä»¥ä¸Šæ­¥éª¤å®Œæˆ

  * > æ­¤æ—¶å‘ç°è¿›è¡Œç›¸å…³æ“ä½œä¹‹åæ•°æ®ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥actionRefï¼Œå®ƒå¯ä»¥æ‹¿åˆ°proTableçš„æ§åˆ¶æƒï¼Œä½¿ç”¨actionRef.current?.reload()





### æ¨¡æ‹Ÿæ¥å£é¡¹ç›®ï¼ˆsmartapi-interfaceï¼‰ï¼ˆåç«¯ï¼‰

æä¾›ä¸‰ä¸ªæ¨¡æ‹Ÿæ¥å£

1. GETæ¥å£
2. POSTæ¥å£ï¼ˆurlä¼ å‚ï¼‰
3. POSTæ¥å£ï¼ˆRestfulï¼‰





### å¼€å§‹å¼€å‘æ¨¡æ‹Ÿæ¥å£é¡¹ç›®éƒ¨åˆ†

é‡‡ç”¨åˆ›å»ºå‡ ä¸ªcontrolleræ§åˆ¶å±‚å°æ¥å£ï¼Œå‰ç«¯ä¼ å‚è¿›è¡Œè°ƒç”¨ï¼Œä½†æ˜¯è¿™æ ·ä¸ç¬¦åˆé€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡åç«¯æ¥è¿›è¡Œä¼ å‚ï¼



### å¼€å‘è°ƒç”¨æ¥å£

å‡ ç§HTTPè°ƒç”¨æ–¹å¼

	1. HttpClient
	1. RestTemplete
	1. å·¥å…·ï¼ˆOKHttpã€HuToolï¼‰

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨HuToolæ¥è¿›è¡Œè°ƒç”¨[HuTool](https://hutool.cn/docs/#/)



å‚è€ƒæ–‡æ¡£æ˜¯ä¸€ä¸ªå¥½ä¸œè¥¿ï¼Œåˆ©ç”¨å¥½



é‚£ä¹ˆç°åœ¨å·²ç»å¼€å‘å¥½è°ƒç”¨æ¥å£äº†ï¼Œä½†æ˜¯ç”¨æˆ·è°ƒç”¨ä½ çš„æ¥å£ï¼Œæˆ–è€…é»‘å®¢é»‘ä½ çš„æ¥å£ï¼Œæ‰€ä»¥éœ€è¦å¯¹è°ƒç”¨è€…è¿›è¡Œä¸€ä¸ªè°ƒç”¨é™åˆ¶ï¼Œé‚£ä¹ˆå¦‚ä½•åŠ ä»¥é™åˆ¶ï¼Ÿ

è¿™æ—¶å¯ä»¥è”æƒ³ä¸€ä¸‹æˆ‘ä»¬å¹³æ—¶è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£æ—¶ï¼Œéƒ½ä¼šæœ‰ä¸€äº›key



### API ç­¾åè®¤è¯ï¼ˆå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æœ‰ç‚¹è¿·æƒ‘ï¼Œåç»­æ‹é¡ºï¼‰



**æœ¬è´¨ï¼š**

1. ç­¾å‘ç­¾å

	2. ä½¿ç”¨ç­¾å(æ ¡éªŒç­¾å)



**ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ**

1. ä¿è¯å®‰å…¨æ€§ï¼Œä¸èƒ½éšä¾¿ä¸€ä¸ªäººå°±å¯ä»¥è°ƒç”¨



**æ€ä¹ˆå®ç°ï¼Ÿï¼ˆå¤æ‚ã€æ— åºã€æ— è§„å¾‹ï¼‰**

é€šè¿‡http request headerå¤´ä¼ é€’å‚æ•°ã€‚

å‚æ•°1ï¼šassesKeyï¼šè°ƒç”¨çš„æ ‡è¯†ï¼ˆä¸€ä¸²æ— è§„åˆ™å­—ç¬¦ä¸²ï¼‰ User Aã€B

å‚æ•°2ï¼šsecretKeyï¼šç›¸å½“äºå¯†ç 

ä¹Ÿå°±æ˜¯ç”¨æˆ·åå’Œå¯†é’¥ï¼ŒåŒºåˆ«å°±æ˜¯akã€skæ˜¯æ— çŠ¶æ€çš„

åœ¨æœåŠ¡ç«¯æ•°æ®åº“è¡¨ä¸­æ–°å¢ä»¥ä¸Šä¸¤ä¸ªå­—æ®µï¼Œç”¨æˆ·å®¢æˆ·ç«¯è¿›è¡Œæ ¡éªŒã€‚





ä½†æ˜¯è¿™æ ·çš„æ–¹æ³•æ—¶å®¹æ˜“è¢«æ‹¦æˆªçš„ï¼Œä¸èƒ½æŠŠå¯†é’¥ç›´æ¥åœ¨æœåŠ¡å™¨ä¹‹é—´è¿›è¡Œä¼ é€’ï¼Œè¦è¿›è¡ŒåŠ å¯†ã€‚æ‰€ä»¥è¦å¯¹å¯†ç è¿›ä¸€æ­¥è¿›è¡ŒåŠ å¯†ã€‚



å‚æ•°3ï¼šç”¨æˆ·è¯·æ±‚å‚æ•°ï¼ˆæ›´ä¸¥æ ¼ï¼‰



å‚æ•°4ï¼šsign

åŠ å¯†æ–¹å¼ï¼šå¯¹ç§°æœºå¯†ã€éå¯¹ç§°åŠ å¯†ã€ä¸å¯è§£å¯†åŠ å¯†ï¼ˆMD5ï¼‰



ç”¨æˆ·å‚æ•° + å¯†é’¥ ==ã€‹ **ç­¾åç”Ÿæˆç®—æ³•** ==ã€‹ä¸å¯è§£å¯†çš„å€¼

wl + abcdefgh ==ã€‹afdasfafszvï¼ˆé€šè¿‡ç­¾åç®—æ³•åŠ å¯†ï¼‰

é‚£ä¹ˆå¦‚ä½•çŸ¥é“è¿™ä¸ªç­¾åæ˜¯å¦æ­£ç¡®ï¼Ÿ

**æœåŠ¡ç«¯ä¼šé€šè¿‡ç”¨ä¸€æ‘¸ä¸€æ ·çš„å‚æ•°å’Œç®—æ³•å»ç”Ÿæˆç­¾åï¼Œåªè¦å’Œç”¨æˆ·æ‰èƒ½å±çš„ç­¾åä¸€è‡´ï¼Œåˆ™æ­£ç¡®!**





**æ€ä¹ˆé˜²é‡æ”¾ï¼Ÿ**

å‚æ•°5ï¼šåŠ nonceéšæœºæ•°ï¼Œä¿è¯åªèƒ½ç”¨ä¸€æ¬¡ï¼Œä½†æ˜¯æœåŠ¡ç«¯ä¹Ÿè¦ä¿å­˜éšæœºæ•°

å‚æ•°6ï¼štimestampæ—¶é—´æˆ³ï¼ˆåŠ ä¸Šæ—¶é—´æˆ³å¯ä»¥ä¿è¯éšæœºæ•°å¯ä»¥æ¸…é™¤ï¼‰

**APIç­¾åè®¤è¯æ˜¯ä¸€ä¸ªå¾ˆçµæ´»çš„è®¾è®¡ï¼Œå…·ä½“è¦æœ‰å“ªäº›å‚æ•°ã€å‚æ•°åä¸€å®šè¦æ ¹æ®å®é™…åœºæ™¯æ¥ï¼ˆæ¯”å¦‚userIdã€appIdã€versionã€å›ºå®šå€¼ç­‰ï¼‰**



æ€è€ƒï¼šéš¾é“å¼€å‘è€…æ¯æ¬¡è°ƒç”¨æ¥å£éƒ½éœ€è¦è‡ªå·±æ¥å†™ç­¾åç®—æ³•å—ï¼Ÿ









### å¼€å‘ä¸€ä¸ªç®€å•æ˜“ç”¨çš„SDK



ç†æƒ³æƒ…å†µï¼šå¼€å‘è€…åªéœ€è¦å…³å¿ƒè°ƒç”¨å“ªäº›æ¥å£ã€ä¼ é€’å“ªäº›å‚æ•°ï¼Œå°±è·Ÿè°ƒç”¨è‡ªå·±çš„ä»£ç ä¸€æ ·ç®€å•ã€‚



å¼€å‘staterçš„å¥½å¤„ï¼š

1. å¼€å‘è€…å¼•å…¥ä¹‹åï¼Œå¯ä»¥ç›´æ¥åœ¨application.ymlä¸­å†™é…ç½®ï¼Œè‡ªåŠ¨åˆ›å»ºå®¢æˆ·ç«¯ã€‚



### åˆ›å»ºSDKé¡¹ç›®ï¼ˆå¼€å‘starterï¼‰ï¼ˆç®€å†äº®ç‚¹ï¼‰

å¼•å…¥ä¾èµ–ï¼š

1. lombook
2. Spring Configuration Processorï¼ˆè‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶å†™ä»£ç çš„æç¤ºï¼‰



æ”¹é€ pomä¾èµ–ï¼Œä¸€å®šè¦åˆ æ‰buildæ ‡ç­¾å†…çš„ä»£ç ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿›è¡Œæ„å»ºä¾èµ–åŒ…ï¼Œä¸æ˜¯è¦ç›´æ¥è¿è¡Œçš„jarçš„é¡¹ç›®





å°è¯•æŠŠæ‰“å¥½çš„åŒ…å‘å¸ƒåˆ°mavenä¸­









## Day03 æ¥å£ä¿æŠ¤ä¸ä¼˜åŒ–



> æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°é±¼æ€»çš„åç«¯é¡¹ç›®æ¨¡å—ä¸­å·²ç»åŒ…å«å‰é¢å•ç‹¬åˆ›å»ºå¥½çš„SDKå’Œinterfaceæ¨¡æ‹Ÿæ¥å£é¡¹ç›®äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æŠŠè¿™ä¸¤ä¸ªæ·»åŠ åˆ°åç«¯çš„é¡¹ç›®ä¸­å‘¢ï¼Ÿ
>
> æ–¹æ¡ˆä¸€ï¼š
>
> â€‹	å—å°šåŒ»é€šé¡¹ç›®çš„å½±å“ï¼Œæˆ‘æƒ³åº”è¯¥å¯ä»¥é€šè¿‡å¢åŠ å­æ¨¡å—çš„æ–¹æ³•æ‹‰è¿›è¡Œæ·»åŠ ï¼Œä½†æ˜¯æ·»åŠ ä¹‹åå¥½åƒæ˜¯ä¸å¤ªè¡Œï¼Œè·Ÿé±¼æ€»çš„ä¸ä¸€æ ·ï¼Œè¿™ç§æ–¹æ³•åº”è¯¥æ˜¯å¯ä»¥ä½¿å¤šä¸ªé¡¹ç›®åœ¨åŒä¸€ä¸ªçª—å£ä¸­æ‰“å¼€ï¼ˆè§£å†³äº†ä¹‹å‰æˆ‘çš„ç–‘è™‘ï¼‰
>
> æ–¹æ¡ˆäºŒï¼š
>
> â€‹	æˆ‘ä»¬çœ‹åˆ°é±¼æ€»çš„åç«¯é¡¹ç›®ä¸­ï¼Œå¦å¤–ä¸¤ä¸ªé¡¹ç›®ï¼ˆSDKå’Œinterfaceï¼‰æ˜¯ä¸¤ä¸ªç›®å½•çš„æ ‡è¯†ï¼Œäºæ˜¯æˆ‘å°±ç›´æ¥å¤åˆ¶ç²˜è´´åˆ°åç«¯é¡¹ç›®çš„æ–‡ä»¶å¤¹ä¸­äº†ï¼Œç„¶åJavaæºæ–‡ä»¶ä¼šå˜æˆçº¢Jï¼Œå¯ä»¥é€šè¿‡å³é”®rscä¸‹mainä¸‹çš„Javaæ–‡ä»¶å¤¹ï¼Œç„¶åmark Directory as--ã€‹Sources Rootï¼Œå°†Javaæ–‡ä»¶å¤¹æ ‡è®°ä¸ºæºç æ ¹ç›®å½•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š
>
> ![image-20230708205543307](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307092023528.png)
>
> ç„¶åæˆ‘ä»¬å‘ç°mavençš„pomä¾èµ–æ–‡ä»¶çš„å›¾æ ‡ä¹Ÿä¸å¯¹ï¼Œä¹Ÿé€šè¿‡æ¡è¨€çš„æ–¹æ³•ï¼Œå³é”®--ã€‹add maven projectæ ‡è®°ä¸ºmavené¡¹ç›®ï¼Œå¤§åŠŸå‘Šæˆï¼

1.å¼€å‘æ¥å£å‘å¸ƒ/ä¸‹çº¿çš„åŠŸèƒ½ï¼ˆç®¡ç†å‘˜ï¼‰

2.å‰ç«¯æµè§ˆæ¥å£ï¼ŒæŸ¥çœ‹ æ¥å£æ–‡æ¡£ï¼Œç”³è¯·ç­¾åï¼ˆæ³¨å†Œï¼‰

3.åœ¨çº¿æµ‹è¯•ï¼ˆç”¨æˆ·ï¼‰

4.ç»Ÿä¸€ç”¨æˆ·è°ƒç”¨æ¥å£æ¬¡æ•°

5.ä¼˜åŒ–ç³»ç»Ÿ-APIç½‘å…³

### å¼€å‘æ¥å£å‘å¸ƒ/ä¸‹çº¿çš„åŠŸèƒ½ï¼ˆä»…ç®¡ç†å‘˜ï¼‰ 

> æ­¤å¤„åˆæ¶‰åŠåˆ°äº†ä¸€ä¸ªå¾…å­¦çŸ¥è¯†ç‚¹ï¼š
>
> Springçš„AOPåˆ‡é¢åº”ç”¨
>
> å¯ä»¥ç”¨æ¥é€šè¿‡æ³¨è§£çš„æ–¹å¼è¿›è¡Œæƒé™ç®¡ç†ã€‚

### åç«¯æ¥å£ï¼š 

**å‘å¸ƒæ¥å£**ï¼ˆä»…ç®¡ç†å‘˜ï¼‰ 

1.æ ¡éªŒè¯¥æ¥å£æ˜¯å¦å­˜åœ¨

2.åˆ¤æ–­æ¥å£æ˜¯å¦å¯ä»¥è¢«è°ƒç”¨

â€‹	åˆ©ç”¨å¼€å‘å¥½çš„SDKï¼Œé€šè¿‡è°ƒç”¨æ¥å£çœ‹æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œè°ƒç”¨çš„é€š

â€‹	ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨smartapi-interfaceé¡¹ç›®

â€‹	ç¬¬äºŒæ­¥ï¼šåœ¨smartapi-backendä¸­å¼•å…¥SDKçš„ä¾èµ–

â€‹	ç¬¬ä¸‰æ­¥ï¼šåœ¨application.ymlä¸­å†™å…¥akã€sk

â€‹	ç¬¬å››æ­¥ï¼šåœ¨æ¥å£ä¸­å¼•å…¥å®¢æˆ·ç«¯çš„å®ä¾‹

â€‹			@Resource

â€‹			private SmartApiClient smartapiclient

> TODO:
>
> > >  1. åˆ¤æ–­æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨æ—¶ï¼Œç”±å›ºå®šæ–¹æ³•åæ”¹ä¸ºå¯ä»¥æ ¹æ®æµ‹è¯•åœ°å€è¿›è¡Œè°ƒç”¨
> > >  2. ç”¨æˆ·æµ‹è¯•æ¥å£åˆ¤æ–­æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨æ—¶ï¼Œç”±å›ºå®šæ–¹æ³•åæ”¹ä¸ºå¯ä»¥æ ¹æ®æµ‹è¯•åœ°å€è¿›è¡Œè°ƒç”¨

3.ä¿®æ”¹æ•°æ®åº“æ¥å£å­—æ®µä¸º1

**ä¸‹çº¿æ¥å£**ï¼ˆä»…ç®¡ç†å‘˜ï¼‰ 

1.æ ¡éªŒè¯¥æ¥å£æ˜¯å¦å­˜åœ¨

2.ä¿®æ”¹æ•°æ®åº“æ¥å£å­—æ®µä¸º 0

æŒ‰é’®å·²æ·»åŠ å¹¶å®Œå–„ã€‚æµ‹è¯•ä¸­å‡ºç°ä¸€ä¸ªç»å…¸é—®é¢˜ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

![image-20230710000821503](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307100008989.png)



> å¾…åŠäº‹ä»¶ï¼š
>
> æµç¨‹ï¼š
>
> 
>
> **å‰ç«¯**æ·»åŠ ä¸Šçº¿ã€ä¸‹çº¿æŒ‰é’®ã€âˆšã€å¢åŠ ç”¨æˆ·æµè§ˆé¡µé¢ã€æŸ¥çœ‹æ¥å£æ–‡æ¡£ã€ç”³è¯·ç­¾å
>
> **åç«¯**ç”³è¯·ç­¾åï¼ˆæ›´æ”¹å®Œå–„æ•°æ®åº“å†™ç”Ÿæˆç­¾åçš„ç®—æ³•ï¼‰
>
> **å‰ç«¯**
>
> æ–°å¢åœ¨çº¿è°ƒç”¨çš„æŒ‰é’®
>
> **åç«¯**
>
> å¼€å‘åœ¨çº¿è°ƒç”¨çš„æ¥å£
>
> 







### å‰ç«¯æµè§ˆæ¥å£

```react
import { PageContainer } from '@ant-design/pro-components';
import React, {useEffect, useState} from 'react';
import {List, message} from "antd";
import {
  listInterfaceInfoByPageUsingGET
} from "@/services/smartapi-backend/interfaceInfoController";


/**
 * ä¸»é¡µ
 * @constructor
 */
const Index: React.FC = () => {

  const [loading, setLoading] = useState(false);
  const [list, setList] = useState<API.InterfaceInfo[]>([]);
  const [total ,setTotal] = useState<number>(0);

  const loadData = async (current=1 , pageSize = 8 ) =>{
    setLoading(true);
    try {
      const res = await listInterfaceInfoByPageUsingGET({
        current,pageSize
      });
      setList(res?.data?.records ?? []);
      setTotal(res?.data?.total ?? 0);

    } catch (error: any) {

      message.error('è¯·æ±‚å¤±è´¥,'+error.message);
      return false;
    }
    setLoading(false);
  }
  useEffect(() => {
    loadData();
  },[])


  return (
    <PageContainer title="åœ¨çº¿æ¥å£å¼€æ”¾å¹³å°">
      <List
        className="my-list"
        loading={loading}
        itemLayout="horizontal"
        dataSource={list}
        renderItem={item => {

          const apiLink =`/interface_info/${item.id}`;
          return(
            <List.Item
              actions={[<a key={item.id} href={apiLink}>æŸ¥çœ‹</a>]}
            >
              <List.Item.Meta
                title={<a href={apiLink}>{item.name}</a>}
                description={item.description}
              />
            </List.Item>
          )
        }

        }
        pagination ={
          {
            // eslint-disable-next-line @typescript-eslint/no-shadow
            showTotal(total: number){
              return 'æ€»æ•°ï¼š' +total;
            },
            pageSize: 8,
            total,
            onChange(page,pageSize){
              loadData(page,pageSize);
            }
          }
        }
      />
    </PageContainer>
  );
};

export default Index;
```

### æŸ¥çœ‹æ¥å£æ–‡æ¡£

```react
import { PageContainer } from '@ant-design/pro-components';
import React, {useEffect, useState} from 'react';
import {Card, Descriptions, message} from "antd";
import {
  getInterfaceInfoByIdUsingGET,

} from "@/services/smartapi-backend/interfaceInfoController";
import { useParams} from "@@/exports";


/**
 * ä¸»é¡µ
 * @constructor
 */
const Index: React.FC = () => {

  const [loading, setLoading] = useState(false);
  const [data, setData] = useState<API.InterfaceInfo>();
  const params  = useParams();

  const loadData = async () =>{
    if (!params.id){
      message.error('å‚æ•°ä¸å­˜åœ¨');
      return ;
    }
    setLoading(true);
    try {
      const res = await getInterfaceInfoByIdUsingGET({
        id: Number(params.id)
      });
      setData(res.data);

    } catch (error: any) {

      message.error('è¯·æ±‚å¤±è´¥,'+error.message);
      return false;
    }
    setLoading(false);
  }
  useEffect(() => {
    loadData();
  },[])

  return (
    <PageContainer title="æŸ¥çœ‹æ¥å£æ–‡æ¡£">
      <Card>
        {
          data?(
            <Descriptions title={data.name} column={1}>
              <Descriptions.Item label="æè¿°">{data.description}</Descriptions.Item>
              <Descriptions.Item label="æ¥å£çŠ¶æ€">{data.status? 'æ­£å¸¸': 'å…³é—­'}</Descriptions.Item>
              <Descriptions.Item label="è¯·æ±‚åœ°å€">{data.url}</Descriptions.Item>
              <Descriptions.Item label="è¯·æ±‚æ–¹æ³•">{data.method}</Descriptions.Item>
              <Descriptions.Item label="è¯·æ±‚å¤´">{data.requestHeader}</Descriptions.Item>
              <Descriptions.Item label="å“åº”å¤´">{data.responseHeader}</Descriptions.Item>
              <Descriptions.Item label="åˆ›å»ºæ—¶é—´">{data.createTime}</Descriptions.Item>
              <Descriptions.Item label="æ›´æ–°æ—¶é—´">{data.updateTime}</Descriptions.Item>
            </Descriptions>
          ):(
            <>æ¥å£ä¸å­˜åœ¨</>
          )}
      </Card>
    </PageContainer>
  );
};

export default Index;
```

### ç”³è¯·ç­¾åï¼ˆæ³¨å†Œï¼‰ 

é€šè¿‡æ•°æ®åº“æ–°å¢å­—æ®µã€æ›´æ”¹ç”¨æˆ·æ³¨å†Œçš„é€»è¾‘ï¼ˆä½¿ç”¨DigestUtilåŠ å¯†ç®—æ³•ç”Ÿæˆakã€skï¼Œç„¶ååŠ å…¥æ•°æ®åº“ï¼‰

> ç•™ä¸€ä¸ªå°ä½œä¸š:
>
> æ–°å¢ä¸€ä¸ªå°æ‹“å±•åŠŸèƒ½ï¼šç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ›´æ”¹è‡ªå·±çš„akã€sk

### æ–°å»ºçœŸå®æ•°æ®ï¼ˆå‰ç«¯ï¼‰

**æ–°å»ºè¿™äº›çœŸå®çš„æ•°æ®**

```text
getUsernameByPost,

è·å–ç”¨æˆ·å,

http://localhost:8123/name/user,

{â€Content-Typeâ€œ: â€application/jsonâ€œ},

{â€Content-Typeâ€œ: â€application/jsonâ€œ},

```

oh my godï¼Œæ­¤æ—¶å‘ç°é—å¿˜äº†ä¸€ä¸ªé‡è¦çš„è¯·æ±‚å‚æ•°å­—æ®µï¼Œäºæ˜¯é€šè¿‡å»ºè¡¨è¯­å¥ã€IDEAå®¢æˆ·ç«¯modify tableï¼Œæ¥å¢åŠ è¿™ä¹ˆä¸€ä¸ªå­—æ®µã€‚

ä¿®æ”¹ç›¸åº”çš„modelå®ä½“åŒ…ä¸­çš„å­—æ®µä¿¡æ¯ä»¥åŠå‘mybatisplus.xmlä¸­æ·»åŠ è¿™ä¸ªå­—æ®µã€‚

é‡å¯é¡¹ç›®---ã€‹å‰ç«¯é‡æ–°ä½¿ç”¨openaiæ’ä»¶ç”Ÿæˆæ¥å£

å‰ç«¯ä¹Ÿéœ€è¦å®Œå–„ä¿®æ”¹ç»„ä»¶çš„è¡¨å•åˆ—åï¼Œæ–°å¢ä¸€ä¸ªrequestParams

å®Œæˆï¼

**å®Œå–„æ¥å£ä¿¡æ¯çš„è¯·æ±‚å‚æ•°ä¿¡æ¯**

**åœ¨çº¿è°ƒç”¨**

å‰ç«¯ç•Œé¢çš„ç¼–å†™ï¼Œé€šè¿‡ant designç»„ä»¶åº“åˆ©ç”¨ç°æˆçš„è¡¨å•ç»„ä»¶æ¥å®Œæˆåœ¨çº¿æŒ‰é’®çš„æ·»åŠ ä¸è¯·æ±‚å‚æ•°çš„åŸºæœ¬è¡¨å•ã€‚

![image-20230710023831281](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307100238354.png)

è¯·æ±‚å‚æ•°çš„ç±»å‹ï¼ˆJSONç±»å‹ï¼‰

> åˆä¸€ä¸ªå°ä½œä¸šï¼š
>
> åœ¨çº¿è°ƒç”¨çš„æ‰©å±•ç‚¹ï¼š
>
> å…ˆè·‘é€šæ•´ä¸ªæµç¨‹ï¼Œç„¶åæ ¹æ®è¯·æ±‚å¤´å’Œè¯·æ±‚ç±»å‹çš„ä¸åŒè®¾è®¡ä¸åŒçš„è¡¨å•å’Œç•Œé¢ï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒ



### åç«¯è°ƒç”¨æµç¨‹

![image-20230710024253445](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307100242406.png)

æŒ‰ç…§æ ‡å‡†çš„ä¼ä¸šå¼€å‘æµç¨‹æ¥è¯´ï¼š

ä¸€å®šä¼šé€‰æ‹©ç¬¬ä¸€ç§å¼€å‘æ–¹å¼ï¼Œä¸ç„¶åæœŸçš„ç½‘å…³ä¸è®¡è´¹å°±æ¯«æ— ä½œç”¨ï¼Œ

ç¬¬äºŒç§æ–¹å¼å¯ä»¥ç”¨æ¥è‡ªå·±è°ƒç”¨æµ‹è¯•ã€‚



æµç¨‹ï¼š

1. å‰ç«¯å°†ç”¨æˆ·è¾“å…¥çš„è¯·æ±‚å‚æ•°ä¸è¦è¿›è¡Œæµ‹è¯•çš„æ¥å£idå‘ç»™å¹³å°åç«¯
2. åœ¨è°ƒç”¨å‰è¿›è¡Œä¸€äº›æ ¡éªŒ
3. å¹³å°åç«¯å»è°ƒç”¨æ¨¡æ‹Ÿæ¥å£

```Java
/**
     * æµ‹è¯•è°ƒç”¨
     *
     * @param interfaceInfoInvokeRequest
     * @param request
     * @return
     */
    @PostMapping("/invoke")
    public BaseResponse<Object> invokeInterfaceInfo(@RequestBody InterfaceInfoInvokeRequest interfaceInfoInvokeRequest,
                                                    HttpServletRequest request) {
        if (interfaceInfoInvokeRequest == null || interfaceInfoInvokeRequest.getId() <= 0) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR);
        }
        long id = interfaceInfoInvokeRequest.getId();
        String userRequestParams = interfaceInfoInvokeRequest.getUserRequestParams();
        // åˆ¤æ–­æ˜¯å¦å­˜åœ¨
        InterfaceInfo oldInterfaceInfo = interfaceInfoService.getById(id);
        if (oldInterfaceInfo == null) {
            throw new BusinessException(ErrorCode.NOT_FOUND_ERROR);
        }
        if (oldInterfaceInfo.getStatus() == InterfaceInfoStatusEnum.OFFLINE.getValue()) {
            throw new BusinessException(ErrorCode.PARAMS_ERROR, "æ¥å£å·²å…³é—­");
        }
        User loginUser = userService.getLoginUser(request);
        String accessKey = loginUser.getAccessKey();
        String secretKey = loginUser.getSecretKey();
        MyClient tempClient = new MyClient(accessKey, secretKey);
        Gson gson = new Gson();
        com.wl.smartapiclientsdk.model.User user = gson.fromJson(userRequestParams, com.wl.smartapiclientsdk.model.User.class);
        String usernameByPost = tempClient.getUserNameByPost(user);
        return ResultUtils.success(usernameByPost);
    }
```

åç«¯è°ƒç”¨é€»è¾‘å·²å®Œæˆ

ç°åœ¨ç»§ç»­å®Œå–„å‰ç«¯çš„æ¥å£ï¼Œå°†å‰ç«¯ç‚¹å‡»è°ƒç”¨æŒ‰é’®åæ”¹ä¸ºæˆ‘ä»¬åˆšæ‰é€šè¿‡åç«¯å®ç°çš„çœŸå®çš„åŠŸèƒ½ã€‚

```
const onFinish = (values: any) => {
    if (!params.id){
      message.error('æ¥å£ä¸å­˜åœ¨');
      return ;
    }
    try {
      invokeInterfaceInfoUsingPOST({
        id: params.id,
        ...values
      })
      message.success('è¯·æ±‚æˆåŠŸ');
      return true;
    } catch (error: any) {
      message.error('è¯·æ±‚å¤±è´¥ï¼Œ' + error.message);
    }
  };
```

é€»è¾‘æ‰“é€šä¹‹åè¿˜è¦è¿›è¡Œå›æ˜¾æ•°æ®ï¼š

```
// async æ˜¯è®¾ç½®åŒæ­¥çš„æ„æ€

 const onFinish = async (values: any) => {
    if (!params.id){
      message.error('æ¥å£ä¸å­˜åœ¨');
      return ;
    }
    try {
// ç­‰å¾…

      const res = await invokeInterfaceInfoUsingPOST({
        id: params.id,
        ...values
      })
// å°†res.dataèµ‹ç»™setInvokeRes

      setInvokeRes(res.data);
      message.success('è¯·æ±‚æˆåŠŸ');
      return true;
    } catch (error: any) {
      message.error('è¯·æ±‚å¤±è´¥ï¼Œ' + error.message);
    }
  };
```

ç„¶ååœ¨è¡¨å•å¤„æ–°å¢ä¸€ä¸ªå¡ç‰‡ï¼Œç”¨äºæ¥æ”¶invokeResè¿›è¡Œæ•°æ®å›æ˜¾ã€‚

å·²å®Œæˆï¼Œæµ‹è¯•é€šè¿‡ï¼

å¹¶ä¸”å®Œå–„äº†ä¸€ä¸ªç¼“å†²æ˜¾ç¤ºçš„loading



TODO:

> >  1. åˆ¤æ–­æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨æ—¶ï¼Œç”±å›ºå®šæ–¹æ³•åæ”¹ä¸ºå¯ä»¥æ ¹æ®æµ‹è¯•åœ°å€è¿›è¡Œè°ƒç”¨
> >  2. ç”¨æˆ·æµ‹è¯•æ¥å£åˆ¤æ–­æ¥å£æ˜¯å¦å¯ä»¥è°ƒç”¨æ—¶ï¼Œç”±å›ºå®šæ–¹æ³•åæ”¹ä¸ºå¯ä»¥æ ¹æ®æµ‹è¯•åœ°å€è¿›è¡Œè°ƒç”¨
> >  3. æ­¤æ—¶ä»»ä½•äººè°ƒç”¨æ¨¡æ‹Ÿæ¥å£éƒ½æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„SDKæ˜¯å†™æ­»åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ï¼Œæ‰€ä»¥åç»­å†è¿›è¡Œå®Œå–„ï¼Œä»æ•°æ®åº“ä¸­è¿›è¡Œæ ¡éªŒï¼



overï¼

ä¸‹é¢æˆ‘ä»¬çš„ç½‘å…³ç”¨Spring Cloud GateWayå®ç°



## Day04 

1. å¼€å‘æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡  20min

2. ä¼˜åŒ–ç³»ç»Ÿçš„æ¶æ„---å­¦ä¹ æ¶æ„è®¾è®¡ã€æ¥è§¦åº”ç”¨åœºæ™¯==>é¢å¯¹ä¸€ä¸ªéœ€æ±‚å°±ä¼šè‡ªç„¶è€Œç„¶åœ°æé«˜å¼€å‘æ•ˆç‡ã€‚ 60min

   ï¼ˆæ€ä¹ˆæŠŠä¸€ä¸ªé¡¹ç›®çš„æ¶æ„è®¾è®¡åšçš„æ›´åŠ åˆç†ï¼Œæ¶‰åŠåˆ°APIç½‘å…³çš„çŸ¥è¯†ï¼‰

   * ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿ
   * ç½‘å…³çš„ä½œç”¨ï¼Ÿ
   * ç½‘å…³çš„åº”ç”¨åœºæ™¯ä»¥åŠå®ç°ï¼Ÿ
   * ç»“åˆä¸šåŠ¡å»åº”ç”¨ç½‘å…³

### æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡

éœ€æ±‚ï¼š

	1. ç”¨æˆ·æ¯æ¬¡è°ƒç”¨æ¥å£æˆåŠŸï¼Œæ¬¡æ•°åŠ 1ï¼ˆæˆ–è€…è®¾å®šä¸€å®šçš„è°ƒç”¨æ¬¡æ•°ï¼Œæ¯æ¬¡å‡1ï¼‰
	1. ç»™ç”¨æˆ·åˆ†é…æˆ–è€…ç”¨æˆ·è‡ªåŠ©ç”³è¯·æ¥å£è°ƒç”¨æ¬¡æ•°

> ä¸šåŠ¡æµç¨‹ï¼š
>
> 1. ç”¨æˆ·è°ƒç”¨æ¥å£ï¼ˆä¹‹å‰å·²å®Œæˆï¼‰
> 2. ä¿®æ”¹æ•°æ®åº“ï¼Œè°ƒç”¨æ¬¡æ•°ï¼ˆåŠ 1æˆ–è€…å‡1ï¼‰

è®¾è®¡åº“è¡¨ï¼š

> å“ªä¸ªç”¨æˆ·ï¼Ÿå“ªä¸ªæ¥å£ï¼Ÿ
>
> ç”¨æˆ· => æ¥å£ï¼ˆå¤šå¯¹å¤šï¼‰

ç”¨æˆ·æ¥å£å…³ç³»è¡¨ï¼š

```
-- ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»è¡¨
create table if not exists smartapi.`user_interface_info`
(
    `id` bigint not null auto_increment comment 'ä¸»é”®' primary key,
    `userId` bigint not null comment 'è°ƒç”¨ç”¨æˆ· id',
    `interfaceInfoId` bigint not null comment 'æ¥å£ id',
    `totalNum` int default 0 not null comment 'æ€»è°ƒç”¨æ¬¡æ•°',
    `leftNum` int default 0 not null comment 'å‰©ä½™è°ƒç”¨æ¬¡æ•°',
    `status` int default 0 not null comment '0-æ­£å¸¸ï¼Œ1-ç¦ç”¨',
    `createTime` datetime default CURRENT_TIMESTAMP not null comment 'åˆ›å»ºæ—¶é—´',
    `updateTime` datetime default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment 'æ›´æ–°æ—¶é—´',
    `isDelete` tinyint default 0 not null comment 'æ˜¯å¦åˆ é™¤(0-æœªåˆ , 1-å·²åˆ )'
) comment 'ç”¨æˆ·è°ƒç”¨æ¥å£å…³ç³»';
```

### æ­¥éª¤ï¼š

1. å¼€å‘åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼ˆç»™ç®¡ç†å‘˜ä½¿ç”¨ï¼‰

   > ç›´æ¥ä½¿ç”¨Mybatis-Xç”Ÿæˆç›¸å…³çš„å®ä½“ç±»ï¼ˆæ³¨æ„åœ¨åˆ é™¤å­—æ®µä¸Šç±³å¨œåŠ ä¸Šé€»è¾‘åˆ é™¤@TableLogicï¼‰ã€mapperã€serviceå®ç°ç±»æ²¡ç„¶åç§»åŠ¨åˆ°é¡¹ç›®å¯¹åº”çš„åŒ…ä¸­ã€‚
   >
   > å¤åˆ¶å†™å¥½çš„Controllerï¼Œæ”¹é‚£äº›å¢åˆ æ”¹æŸ¥ï¼ å®Œæˆâˆš

2. å¼€å‘ç”¨æˆ·è°ƒç”¨æ¥å£æ¬¡æ•°åŠ 1ï¼ˆæˆ–è€…å‡1ï¼‰

   é—®ï¼šå¦‚æœæ¯ä¸ªæ¥å£çš„æ–¹æ³•ï¼Œéƒ½å†™è°ƒç”¨æ¬¡æ•° + 1ï¼Œæ˜¯ä¸æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœåœ¨æœ¬é¡¹ç›®ä¸­ï¼Œå°†è¿™ä¸ªè°ƒç”¨æ¬¡æ•°+ 1ï¼Œå°è£…æˆä¸€ä¸ªæ–¹æ³•ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯`ä»£ç ä¾µå…¥æ€§å¾ˆå¼ºï¼`

   è‡´å‘½é—®é¢˜æ˜¯ï¼šæ¥å£å¼€å‘è€…éœ€è¦è‡ªå·±è¿›è¡Œè°ƒç”¨ï¼

   è§£å†³æ–¹æ³•ï¼š

   1. Springä¸­çš„AOPï¼ˆæ¨èï¼Œæ˜¯Springçš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼‰
   2. Serveletä¸­çš„æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨ï¼ˆFillterï¼‰
   3. é€šç”¨çš„æ–¹æ³•ï¼ˆç¼ºç‚¹ï¼šä»£ç ä¾µå…¥æ€§å¼ºï¼Œéœ€è¦è‡ªå·±è°ƒç”¨ï¼‰
   4. ç½‘å…³



ç®€å•è¯´ä¸€ä¸‹AOPåˆ‡é¢çš„åŸºæœ¬è¿‡ç¨‹ï¼š

> å…ˆè¯´ä¸€ä¸‹AOPåˆ‡é¢çš„ä½œç”¨ï¼š
>
> å°±ç›¸å½“äºåœ¨æ¥å£æˆ–è€…æ–¹æ³•è°ƒç”¨å‰æˆ–è€…è°ƒç”¨ä¹‹åå¸®ä½ åšä¸€äº›äº‹æƒ…ï¼Œå…¶åº•å±‚çš„åŸç†å°±æ˜¯åŠ¨æ€ä»£ç†ã€‚
>
> ä½¿ç”¨AOPåˆ‡é¢çš„
>
> ä¼˜ç‚¹ï¼š
>
> ç‹¬ç«‹äºæ¥å£ï¼Œåœ¨æ¯ä¸ªæ¥å£è°ƒç”¨å‰ååŠ  1
>
> ç¼ºç‚¹ï¼š
>
> åªå­˜åœ¨äºå•ä¸ªé¡¹ç›®ä¸­ï¼Œå¦‚æœæ¯ä¸ªå›¢é˜Ÿéƒ½è¦å†™ä¸€ä¸ªè‡ªå·±çš„åˆ‡é¢
>
> // TODOï¼šä¸‹å»çœ‹ä¸€ä¸‹AOPçš„æµç¨‹ï¼Œç†Ÿæ‚‰ä¸€ä¸‹



æˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ç½‘å…³æ¥å®ç°æ¥å£è°ƒç”¨æ¬¡æ•°ã€‚

ç½‘å…³å°±å½“ä¸åœ¨æ‰€æœ‰æ¥å£çš„å…¥å£å‰åŠ äº†ä¸€å±‚æ£€ç¥¨å£ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

![image-20230716015231451](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307160152994.png)

å› ä¸ºç½‘å…³å®ç°çš„æœ‰è°ƒç”¨æ¬¡æ•°çš„ç»Ÿè®¡ï¼Œæ‰€ä»¥å¼€å‘è€…å¯ä»¥é€šå…³ç½‘å…³æ¥æŸ¥çœ‹ï¼Œè€Œç”¨æˆ·è°ƒç”¨æ¥å£æ—¶ç›´æ¥è¾“å…¥è¯·æ±‚å‚æ•°ã€è¯·æ±‚åœ°å€å³å¯ã€‚

### ç½‘å…³ï¼š

è¿™é‡Œä¸ºä»€ä¹ˆå†™è¿™ä¹ˆå¤šç†è®ºå‘¢ï¼Ÿå†™ä»£ç ä¸ä¸€å®šæ˜¯æœ€é‡è¦çš„ï¼Œé‡è¦çš„æ˜¯æ€æƒ³ï¼é€»è¾‘æ€æƒ³æ˜ç™½ä¹‹åï¼Œæ— éå°±æ˜¯çœ‹æ–‡æ¡£ã€ç™¾åº¦å®ç°ã€‚

> ä»€ä¹ˆæ˜¯ç½‘å…³å‘¢ï¼Ÿå°±ç›¸å½“äºè½¦ç¥¨æ£€ç¥¨å£ï¼Œç»Ÿä¸€å»æ£€ç¥¨ã€‚
>
> ä¼˜ç‚¹ï¼Ÿç»Ÿä¸€å»è¿›è¡Œä¸€äº›æ“ä½œã€å¤„ç†ä¸€äº›é—®é¢˜ã€‚
>
> ä½œç”¨ï¼Ÿ
>
> 1. è·¯ç”±
>
> 2. è´Ÿè½½å‡è¡¡
>
> 3. ç»Ÿä¸€é‰´æƒ
>
> 4. ç»Ÿä¸€å¤„ç†è·¨åŸŸ
>
> 5. ç»Ÿä¸€ä¸šåŠ¡å¤„ç†ï¼ˆç¼“å­˜ï¼‰
>
> 6. è®¿é—®æ§åˆ¶
>
> 7. å‘å¸ƒæ§åˆ¶ï¼ˆç°åº¦å‘å¸ƒï¼Œä¹Ÿå°±æ˜¯æ…¢æ…¢æ§åˆ¶æ¥å£çš„æµé‡ï¼Œä¸æ–­å¼€æ”¾ç»™æ›´å¤šç”¨æˆ·ï¼Œç„¶åè¾¾åˆ°å‡çº§æ¥å£çš„ç›®çš„ï¼‰
>
> 8. æµé‡æŸ“è‰²ï¼ˆç»™æµé‡æ·»åŠ ä¸€äº›æ ‡è¯†ï¼Œæ¯”å¦‚æ–°çš„è¯·æ±‚å¤´ä¿¡æ¯ï¼‰
>
> 9. ç»Ÿä¸€æ¥å£ä¿æŠ¤ 
>
>    1. é™åˆ¶è¯·æ±‚
>
>    2. ä¿¡æ¯è„±æ•ï¼ˆç½‘å…³å¯ä»¥æ“ä½œä½ çš„è¯·æ±‚å£ï¼Œè¿›è€ŒæŠ¹å»æ•æ„Ÿä¿¡æ¯ï¼‰
>
>    3. é™çº§ï¼ˆç†”æ–­ï¼Œä¿é™©èµ·è§ï¼Œæ¥å£ä¸‹çº¿åï¼Œå¯ä»¥è¿”å›ä¸€äº›æç¤ºä¿¡æ¯ï¼‰
>
>    4. é™æµ
>
>       ï¼ˆ// TODOï¼šå­¦ä¹ ä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œå­¦ä¹ éœ²æ¡¶ç®—æ³•ï¼Œå­¦ä¹ ä¸€ä¸‹ï¼‰
>
>    5. RedislimitHandler
>
>    6. è¶…æ—¶æ—¶é—´
>
>    7. é‡è¯•ï¼ˆä¸šåŠ¡ä¿æŠ¤ï¼‰
>
> 10. ç»Ÿä¸€æ—¥å¿—
>
> 11. ç»Ÿä¸€æ–‡æ¡£ï¼ˆå°†ä¸‹æ¸¸é¡¹ç›®çš„æ–‡æ¡£ç»Ÿä¸€èšåˆï¼Œå±•ç¤ºåˆ°ä¸€ä¸ªé¡µé¢ï¼‰



### è·¯ç”±

èµ·åˆ°è½¬å‘çš„ä½œç”¨ï¼Œæ¯”å¦‚æœ‰æ¥å£Aå’Œæ¥å£B,ç½‘å…³ä¼šè®°å½•è¿™äº›ä¿¡æ¯ï¼Œæ ¹æ®ç”¨æˆ·è®¿é—®çš„åœ°å€å’Œå‚æ•°ï¼Œè½¬å‘è¯·æ±‚åˆ°å¯¹åº”çš„æ¥å£ï¼ˆæœåŠ¡å™¨/é›†ç¾¤ï¼‰

ç”¨æˆ·aè°ƒç”¨æ¥å£A

/a=>æ¥å£A /b=>æ¥å£B

https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories

### è´Ÿè½½å‡è¡¡ 

åœ¨è·¯ç”±çš„åŸºç¡€ä¸Šå¯ä»¥è½¬å‘åˆ°æŸä¸€ä¸ªæœåŠ¡å™¨

/c => æœåŠ¡A/ é›†ç¾¤Aï¼ˆéšæœºè½¬å‘åˆ°å…¶ä¸­çš„æŸä¸€ä¸ªæœºå™¨ï¼‰

uriä»å›ºå®šåœ°å€æ”¹æˆb:xx

### ç»Ÿä¸€é‰´æƒ 

åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è¿›è¡Œæ“ä½œï¼Œæ— è®ºè®¿é—®ä»€ä¹ˆæ¥å£ï¼Œæˆ‘éƒ½ç»Ÿä¸€å»åˆ¤æ–­æƒé™ï¼Œä¸ç”¨é‡å¤å†™

### ç»Ÿä¸€å¤„ç†è·¨åŸŸ 

ç½‘å…³ç»Ÿä¸€å¤„ç†è·¨åŸŸï¼Œä¸ç”¨åœ¨æ¯ä¸ªé¡¹ç›®å•ç‹¬å¤„ç†

https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#cors-configuration

### ç»Ÿä¸€ä¸šåŠ¡å¤„ç† 

æŠŠæ¯ä¸ªé¡¹ç›®ä¸­éƒ½è¦åšçš„é€šç”¨é€»è¾‘æ”¾åˆ°ä¸Šå±‚ï¼ˆç½‘å…³ï¼‰ï¼Œç»Ÿä¸€å¤„ç†ï¼Œæ¯”å¦‚æœ¬é¡¹ç›®çš„æ¬¡æ•°ç»Ÿè®¡

### è®¿é—®æ§åˆ¶ 

é»‘ç™½åå•ï¼Œæ¯”å¦‚é™åˆ¶ddos ip

### å‘å¸ƒæ§åˆ¶ 

ç°åº¦å‘å¸ƒï¼Œæ¯”å¦‚ä¸Šçº¿æ–°æ¥å£ï¼Œå…ˆç»™æ–°æ¥å£åˆ†é… 20%æµé‡ï¼Œè€æ¥å£80% ,å†æ…¢æ…¢è°ƒæ•´æ¯”ä¾‹

https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-weight-route-predicate- factory

### æµé‡æŸ“è‰² 

åŒºåˆ†ç”¨æˆ·æ¥æº

ç»™è¯·æ±‚ï¼ˆæµé‡ï¼‰æ·»åŠ ä¸€äº›æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯è®¾ç½®è¯·æ±‚å¤´ä¸­ï¼Œæ·»åŠ æ–°çš„è¯·æ±‚å¤´ https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-addrequestheader-gatewayfilter-factory

å…¨å±€æŸ“è‰²ï¼šhttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#default-filters

### æ¥å£ä¿æŠ¤ 

1 é™åˆ¶è¯·æ±‚ https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#requestheadersiz-gatewayfilter-factory 

2 ä¿¡æ¯è„±æ• https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-removerequestheader-gatewayfilter-factory 

3 é™çº§ï¼ˆç†”æ–­ï¼‰ è¿›è¡Œå…œåº• https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#fallback-headers 

4 é™æµ https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-requestratelimiter-gatewayfilter-factory 

5 è¶…æ—¶æ—¶é—´   è¶…æ—¶å°±ä¸­æ–­ https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#http-timeouts-configuration 

6 é‡è¯•ï¼ˆä¸šåŠ¡ä¿æŠ¤ï¼‰ï¼š https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-retry-gatewayfilter-factory 

### ç»Ÿä¸€æ—¥å¿— 

ç»Ÿä¸€çš„è¯·æ±‚ï¼Œå“åº”ä¿¡æ¯è®°å½•

### ç»Ÿä¸€æ–‡æ¡£ 

å°†ä¸‹æ¸¸é¡¹ç›®çš„æ–‡æ¡£è¿›è¡Œèšåˆï¼Œåœ¨ä¸€ä¸ªé¡µé¢ç»Ÿä¸€æŸ¥çœ‹

å»ºè®®ç”¨ï¼šhttps://doc.xiaominfo.com/docs/middleware-sources/,aggregation-introduction


### ç½‘å…³çš„åˆ†ç±»

1. å…¨å±€ç½‘å…³ï¼ˆæ¥å…¥å±‚ç½‘å…³ï¼‰ï¼šä½œç”¨æ˜¯è´Ÿè½½å‡è¡¡ã€è¯·æ±‚æ—¥å¿—ï¼Œä¸å’Œä¸šåŠ¡é€»è¾‘ç»‘å®š

2. ä¸šåŠ¡ç½‘å…³ï¼ˆå¾®æœåŠ¡ç½‘å…³ï¼šä¼šæœ‰ä¸€äº›ä¸šåŠ¡é€»è¾‘ï¼‰ï¼šä½œç”¨æ˜¯æ ¹æ®ä¸åŒçš„è¯·æ±‚è½¬å‘åˆ°ä¸åŒçš„é¡¹ç›®æ¥å£

   å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/qq21040559/article/,details/,122961395

### å®ç°

1. Nginxï¼ˆæ¨èçš„å…¨å±€å‹ç½‘å…³ï¼‰

2. Kongç½‘å…³ï¼ˆé€‚åˆAPIç½‘å…³ï¼‰--æ”¶è´¹ï¼ï¼

3. `Spring Cloud Gateway`ï¼ˆå–ä»£äº†Zuulï¼Œå› ä¸ºæ¶æ„è®¾è®¡å¹¶ä¸å¤ªå¥½ï¼Œå¹¶å‘é‡ä¹Ÿæœ‰é™ï¼‰

   > ä¼˜ç‚¹ï¼šç”¨åˆ°äº†NIOã€å¤šè·¯å¤ç”¨ã€åº•å±‚Nettyã€Reactæ¨¡å‹ï¼›
   >
   > æœ€å¤§çš„äº®ç‚¹ï¼šå¯ä»¥ç”¨Javaä»£ç å†™é€»è¾‘ï¼Œå…¶ä»–ç½‘å…³éƒ½éœ€è¦å­¦ä¹ ä¸€äº›å…¶ä»–è¯­è¨€ï¼ˆNginxéœ€è¦å­¦åˆ°ä¸€äº›Luaè„šæœ¬ï¼‰

ç½‘å…³æŠ€æœ¯é€‰å‹ï¼šhttps://zhuanlan.zhihu.com/p/500587132

### Spring Cloud Gatewayç”¨æ³•

å®˜ç½‘æ˜¯æœ€å¥½çš„è€æ˜¯å»çœ‹å®˜ç½‘

å»çœ‹å®˜ç½‘ï¼šhttps://spring.io/projects/spring-cloud-gateway

å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.spring.io/spring-cloud-gateway/docs/current/reference//html/





### åˆ›å»ºä¸€ä¸ªGatewayé¡¹ç›®

å°ä½œä¸šï¼šå®Œæˆå®˜ç½‘çš„å°demoï¼ˆç¼–ç¨‹å¼demoï¼‰





## Day05 æŠŠAPIç½‘å…³åº”ç”¨åˆ°é¡¹ç›®ä¸­

ä»»åŠ¡ï¼š

1. å®Œæˆç»Ÿä¸€çš„ç”¨æˆ·é‰´æƒã€ç»Ÿä¸€çš„æ¥å£è°ƒç”¨æ¬¡æ•°ç»Ÿè®¡ï¼ˆAPIç½‘å…³åº”ç”¨ï¼‰
2. å®Œå–„åŠŸèƒ½



### å°†ç”¨åˆ°çš„ç‰¹æ€§

1. è·¯ç”±ï¼ˆè½¬å‘è¯·æ±‚åˆ°æ¨¡æ‹Ÿæ¥å£é¡¹ç›®ï¼‰

2. ~~è´Ÿè½½å‡è¡¡ï¼ˆéœ€è¦ç”¨åˆ°æ³¨å†Œä¸­å¿ƒï¼‰~~
3. ç»Ÿä¸€é‰´æƒ(accessKeyï¼ŒsecretKey)
4. ç»Ÿä¸€å¤„ç†è·¨åŸŸ
5. ç»Ÿä¸€ä¸šåŠ¡å¤„ç†ï¼ˆæ¯æ¬¡è¯·æ±‚æ¥å£åï¼Œæ¥å£è°ƒç”¨æ¬¡æ•°+1ï¼‰
6. è®¿é—®æ§åˆ¶ï¼ˆé»‘ç™½åå•ï¼‰
7. ~~å‘å¸ƒæ§åˆ¶~~
8. æµé‡æŸ“è‰²(è®°å½•è¯·æ±‚æ˜¯å¦ä¸ºç½‘å…³æ¥çš„)
9. ~~ç»Ÿä¸€æ¥å£ä¿æŠ¤~~ 
   1. é™åˆ¶è¯·æ±‚
   2. ä¿¡æ¯è„±æ•
   3. é™çº§ï¼ˆç†”æ–­ï¼‰
   4. é™æµ å­¦ä¹ ä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œå­¦ä¹ éœ²æ¡¶ç®—æ³•ï¼Œå­¦ä¹ ä¸€ä¸‹RedislimitHandler
   5. è¶…æ—¶æ—¶é—´
   6. é‡è¯•ï¼ˆä¸šåŠ¡ä¿æŠ¤ï¼‰
10. ç»Ÿä¸€æ—¥å¿—(è®°å½•æ¯æ¬¡çš„è¯·æ±‚å’Œå“åº”)
11. ~~ç»Ÿä¸€æ–‡æ¡£~~



### ä¸šåŠ¡é€»è¾‘

> ä¸ºä»€ä¹ˆä¼šç”¨åˆ°APIç½‘å…³ï¼Ÿ
>
> ç»“åˆæ¶æ„å›¾æ¥è¯´ï¼Œç®€å•æ¥è¯´ä¹Ÿå°±æ˜¯åŠ ä¸€ä¸ªæ£€ç¥¨å£ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ·»åŠ æµé‡æŸ“è‰²ã€é“¾è·¯è¿½è¸ªçš„åŠŸèƒ½ã€ç°åº¦å‘å¸ƒç­‰ç­‰ã€‚ã€‚ã€‚

1. ç”¨æˆ·å‘é€è¯·æ±‚åˆ°APIç½‘å…³ï¼ˆè¯·æ±‚è½¬å‘ï¼‰
2. *è¯·æ±‚æ—¥å¿—*
3. *é»‘ç™½åå•*
4. ç”¨æˆ·é‰´æƒï¼ˆå¦‚ä½•ï¼Ÿåˆ¤æ–­akã€skï¼‰
5. è¯·æ±‚çš„æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Ÿ
6. è¯·æ±‚è½¬å‘ï¼Œè°ƒç”¨æ¨¡æ‹Ÿæ¥å£
7. å“åº”æ—¥å¿—
8. è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1
9. è°ƒç”¨å¤±è´¥ï¼Œè¿”å›è§„èŒƒé”™è¯¯ç 



### å®ç°

1. **è¯·æ±‚è½¬å‘**

   [ä½¿ç”¨å‰ç¼€åŒ¹é…æ–­è¨€](https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#the-path-route-predicate-factory)

   æ‰€æœ‰è·¯å¾„ä¸ºï¼š`/api/**` çš„è¯·æ±‚è½¬å‘ï¼Œè½¬å‘åˆ°http://localhost:8123/api/**

   æ¯”å¦‚ï¼š

   è¯·æ±‚äºhttp://localhost:8090/api/name/get?/name=wlei224

   è½¬å‘åˆ°http://localhost:8123/api/name/get?/name=wlei224

```yaml
spring:
  cloud:
    gateway:
      routes:
      - id: path_route
        uri: https://example.org
        predicates:
        - Path=/red/{segment},/blue/{segment}
```

2. å…¶ä»–ä¸šåŠ¡é€»è¾‘

> â€‹	todoï¼šSpringæ³¨è§£	  @component

â€‹	ä½¿ç”¨Spring Cloud Gatewayä¸­çš„GlobalFilterå®ç°è¯·æ±‚æ‹¦æˆªå¤„ç†ï¼ˆç±»ä¼¼äºAOPï¼‰

â€‹	![image-20230725194819206](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307251948339.png)

â€‹	[GlobalFilter](https://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-combined-global-filter-and-gatewayfilter-ordering)ç›´æ¥å¤åˆ¶ä»£ç åˆ°ç½‘å…³é¡¹ç›®çš„å…¨å±€å¼‚å¸¸ç±»ä¸­ã€‚

â€‹	éªŒè¯é€šè¿‡âˆš

2. æ­£å¼å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘

> 1. ç”¨æˆ·å‘é€è¯·æ±‚åˆ°APIç½‘å…³ï¼ˆè¯·æ±‚è½¬å‘ï¼‰âˆš
>
>    ä»£ç èƒ½è¿è¡Œåˆ°è¿™ä¸ªcontrollerä¸šåŠ¡é€»è¾‘å±‚ï¼Œå°±è¯´æ˜ç”¨æˆ·å·²ç»å‘é€äº†è¯·æ±‚
>
> 2. *è¯·æ±‚æ—¥å¿—*
>
>    ![image-20230728115938432](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307281159504.png)
>
>    æˆ‘ä»¬å‘ç°è¯·æ±‚å‚æ•°ä¸­å«æœ‰ä¸€ä¸ªäº¤æ¢æœºï¼Œäºæ˜¯å¯ä»¥è¯•ç€ä»è¿™é‡Œæ‰¾åˆ°requestè¯·æ±‚ï¼Œæ‹¿åˆ°è¯·æ±‚å¤´ä¸­çš„ä¿¡æ¯ï¼›
>
>    æ·»åŠ `@Slf4j`æ³¨è§£ï¼Œç”¨log.infoåœ¨æ§åˆ¶å°è¾“å‡ºè¯·æ±‚å¤´æ—¥å¿—ï¼›
>
> 3. *é»‘ç™½åå•*
>
>    åœ¨æƒé™ç®¡ç†ä¸šåŠ¡ä¸­ä¸€èˆ¬è®¾ç½®çš„æ˜¯ç™½åå•ï¼Œè¿™æ ·åªæœ‰å…è®¸çš„æ‰å¯ä»¥è¿›è¡Œè®¿é—®ï¼Œæ›´åŠ å®‰å…¨ï¼
>
>    åœ¨IDEAä¸­ç›´æ¥æ•²`prsf`å†™ä¸€ä¸ªç™½åå•å¸¸é‡ã€‚
>
>    ```Java
>    // 2. è®¿é—®æ§åˆ¶ -- è®¾ç½®é»‘ç™½åå•ï¼ˆå¯ä»¥ç”¨è®¾ç½®å“åº”çŠ¶æ€ç æ¥å®ç°ï¼‰
>    ServerHttpResponse response = exchange.getResponse();
>    if(!IP_WHITE_LIST.contains(sourceAdress)) {
>        // handleNoAuth(response);
>        response.setStatusCode(HttpStatus.FORBIDDEN);
>    	return response.setComplete();
>    }
>    ```
>
>    
>
> 4. ç”¨æˆ·é‰´æƒï¼ˆå¦‚ä½•ï¼Ÿåˆ¤æ–­akã€skï¼‰
>
>    ```java
>    //  ç”¨æˆ·é‰´æƒï¼ˆå¦‚ä½•ï¼Ÿåˆ¤æ–­akã€skï¼‰
>    HttpHeaders headers = request.getHeaders();
>    String accessKey = headers.getFirst("accessKey");
>    String nonce = headers.getFirst("nonce");
>    String timeStamp = headers.getFirst("timeStamp");
>    String sign = headers.getFirst("sign");
>    String body = headers.getFirst("body");
>    // TODO è¦å»æ•°æ®åº“ä¸­æŸ¥è¯¢
>    // ä¸ºäº†æ–¹ä¾¿è¿›è¡Œæ ¡éªŒï¼Œç›´æ¥è¿›è¡Œåˆ¤æ–­æ•°æ®ï¼Œæ­£è§„æ¥è¯´åº”è¯¥ä»æ•°æ®åº“ä¸­è¿›è¡Œæ ¡éªŒæ•°æ®
>    if (!"wl".equals(accessKey)){
>        // throw new RuntimeException("æ— æƒé™ï¼");
>        // å°è£…äº†ä¸€ä¸ªæ–¹æ³•ï¼Œä¸“é—¨ç”¨äºå¤„ç†å¼‚å¸¸è¯·æ±‚
>        return handleNoAuth(response);
>    }
>    if (Long.parseLong(nonce) > 10000L){
>    	return handleNoAuth(response);
>    }
>                                                                                                                   
>    //  æ—¶é—´æˆ³æ ¡éªŒè‡ªå·±å®ç°ï¼Œæ—¶é—´å’Œå½“å‰æ—¶é—´ä¸èƒ½è¶…è¿‡5min
>    Long currentTime = System.currentTimeMillis() / 1000;
>    Long FIVE_MINUTES = 60 * 5L;
>    if ((currentTime-Long.parseLong(timeStamp)) >= FIVE_MINUTES) {
>    	return handleNoAuth(response);
>    }
>                                                                                                                   
>    // TODO è¦å»æ•°æ®åº“ä¸­æŸ¥è¯¢
>    String serverSign = SignUtils.getSign(body, "abcdefgh");
>    if (!serverSign.equals(sign)) {
>    	throw new RuntimeException("æ— æƒé™ï¼");
>    }
>    ```
>
>    
>
> 5. è¯·æ±‚çš„æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Ÿ
>
>    // TODO ä»æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢æ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆä¸¥æ ¼çš„è¯å¯ä»¥å†æ ¡éªŒä¸€ä¸‹è¯·æ±‚å‚æ•°ï¼Œä½†æ˜¯ä¸šåŠ¡å±‚é¢çš„è¯·æ±‚å‚æ•°ä¸å»ºè®®æ”¾åˆ°å…¨å±€è¯·æ±‚ç½‘å…³é‡Œé¢ï¼‰
>    // å› ä¸ºæ•°æ®åº“çš„è®¿é—®æ–¹æ³•å·²ç»å†backendä¸­å·²ç»å†™è¿‡ï¼Œæ“ä½œè¾ƒä¸ºå¤æ‚çš„è¯ä¸å»ºè®®é‡å¤å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿œç¨‹è°ƒç”¨çš„æ–¹å¼ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥è¯´æ˜¯å¾®æœåŠ¡ï¼Œè¿™ä¸ªé¡¹ç›®å®Œå…¨å¯ä»¥å†™æˆå¾®æœåŠ¡ï¼š`OpenFeigh`ï¼Œç›®å‰é¡¹ç›®çš„å®šä½è¿˜æ˜¯`åˆ†å¸ƒå¼é¡¹ç›®`ç»“åˆå¾®æœåŠ¡çš„è¿œç¨‹è°ƒç”¨ï¼Œé¿å…é‡å¤å†™ä¸šåŠ¡é€»è¾‘ï¼‰
>
>    
>
> 6. è¯·æ±‚è½¬å‘ï¼Œè°ƒç”¨æ¨¡æ‹Ÿæ¥å£
>
>    ```java
>    Mono<Void> filter = chain.filter(exchange);
>    ```
>
>    
>
> 7. å“åº”æ—¥å¿—
>
>    ```java
>    log.info("å“åº”ï¼š" + response.getStatusCode());
>    ```
>
>    
>
> 8. è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1
>
>    ```java
>    // TODO invokeCount
>    ```
>
> 9. è°ƒç”¨å¤±è´¥ï¼Œè¿”å›è§„èŒƒé”™è¯¯ç 
>
>    ```Java
>    // ç”¨æˆ·é‰´æƒå¼‚å¸¸
>        public Mono<Void> handleNoAuth(ServerHttpResponse response) {
>            response.setStatusCode(HttpStatus.FORBIDDEN);
>            return response.setComplete();
>        }
>        // è‡ªå®šä¹‰é”™è¯¯å¼‚å¸¸
>        public Mono<Void> handleInvokeError(ServerHttpResponse response) {
>            response.setStatusCode(HttpStatus.INTERNAL_SERVER_ERROR);
>            return response.setComplete();
>        }
>    ```
>
>    
>

* ä¸ºäº†æ–¹ä¾¿è¿›è¡Œä¸šåŠ¡é€»è¾‘çš„ç¼–å†™ï¼Œæˆ‘ä»¬å¯ä»¥å‘ä¸Šé¢ä¸€æ ·ï¼Œå°†æå‰ç¼–å†™å¥½çš„ä¸šåŠ¡æµç¨‹ç²˜è´´åˆ°ç±»æ–‡ä»¶ä¸­ã€‚



### æµ‹è¯•

é€šè¿‡æµ‹è¯•æˆ‘ä»¬å‘ç°ï¼Œé€šè¿‡http://127.0.0.1:8090/api/name/get?name=wlè¿›è¡Œè®¿é—®æ—¶ï¼Œè¿˜æ˜¯ä¼šé­åˆ°æ‹’ç»ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ­¤æ—¶ä¸æ˜¯è¯·æ±‚å¤´ä¸¢å¤±ï¼Œè€Œæ˜¯æˆ‘ä»¬æ ¹æœ¬å°±æ²¡å†™è¯·æ±‚å¤´ï¼Œè·‘é€šè¿™ä¸ªé€»è¾‘çš„è¯ï¼Œå¯ä»¥ä»å‰ç«¯è¿›è¡Œè°ƒç”¨æµ‹è¯•ã€‚

![image-20230803025109861](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202308030251719.png)

### ğŸ§‘â€ğŸ’»ä¸šåŠ¡é€»è¾‘é¢„æœŸç»“æœï¼š

ç­‰æ¨¡æ‹Ÿæ¥å£è°ƒç”¨å®Œæˆï¼Œæ‰è®°å½•å“åº”æ—¥å¿—ã€ç»Ÿè®¡è°ƒç”¨æ¬¡æ•°ã€‚

### å­˜åœ¨é—®é¢˜ï¼š

> è™½ç„¶ä¸Šè¿°ä»£ç å¯ä»¥è·‘é€šï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡debugæ¨¡å¼å¯ä»¥çœ‹åˆ°ï¼Œä»£ç åœ¨æ‰§è¡Œåˆ°è¯·æ±‚è½¬å‘çš„`Mono<Void> filter = chain.filter(exchange);`æ–¹æ³•åï¼Œå¹¶æ²¡æœ‰è¿›å…¥åˆ°æ–¹æ³•ä¸­ï¼Œåè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œç›´åˆ°`chain.filter`æ–¹æ³•ä¹‹åæ‰è¿›å…¥æ¨¡æ‹Ÿæ¥å£æ–¹æ³•ä¸­ã€‚
>
> `åŸå› ï¼š`
>
> chain.filteræ˜¯ä¸ªå¼‚æ­¥æ“ä½œï¼Œå¯ä»¥ç†è§£ä¸ºå‰ç«¯çš„promise
>
> `è§£å†³æ–¹æ¡ˆï¼š`
>
> åˆ©ç”¨Spring Cloud Gatewayæä¾›çš„è‡ªå®šä¹‰å“åº”è£…é¥°å™¨ä¸­çš„responseè£…é¥°è€…ï¼Œä»¥æ¬¡å¢å¼ºåŸæœ‰responseçš„å¤„ç†èƒ½åŠ›
>
> å¼•ç”³ï¼šä»€ä¹ˆå«è£…é¥°è€…è®¾è®¡æ¨¡å¼ï¼Ÿ
>
> â€‹	ä½œç”¨å°±æ˜¯ï¼šåœ¨åŸæœ¬ç±»çš„åŸºç¡€ä¸Šå¯¹åŸæœ‰ç±»çš„èƒ½åŠ›çš„å¢å¼ºï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºç»™responseä¹°äº†ä¸€ä»¶è£…å¤‡ï¼Œæ‹¥æœ‰äº†æ›´å¤šçš„èƒ½åŠ›ã€‚è§£é‡Šæˆä»£ç è¯­è¨€æ„æ€å°±æ˜¯ï¼Œå¢å†™responseéƒ¨åˆ†ä»£ç ï¼Œå®ç°éœ€è¦çš„åŠŸèƒ½ã€‚
>
> `å‚è€ƒåšå®¢ï¼š` 
>
> https://blog.csdn.net/qq_19636353/article/details/126759522  (ä»¥è¿™ä¸ªä¸ºä¸») 
>
> `å…¶ä»–å‚è€ƒï¼š` 
>
> https://blog.csdn.net/m0_67595943/article/details/124667975 
>
> https://blog.csdn.net/weixin_43933728/article/details/121359727?spm=1001.2014.3001.5501 
>
> https://blog.csdn.net/zx156955/article/details/121670681 https://blog.csdn.net/qq_39529562/article/details/108911983

```java
public Mono<Void> handleResponse(ServerWebExchange exchange, GatewayFilterChain chain){  

    try {  
        //ä»äº¤æ¢å¯„æ‹¿å“åº”å¯¹è±¡  
        ServerHttpResponse originalResponse = exchange.getResponse();  
        //ç¼“å†²åŒºå·¥å‚ï¼Œæ‹¿åˆ°ç¼“å­˜æ•°æ®  
        DataBufferFactory bufferFactory = originalResponse.bufferFactory();  
        //æ‹¿åˆ°å“åº”ç   
        HttpStatus statusCode = originalResponse.getStatusCode();  
        if(statusCode == HttpStatus.OK){  
            //è£…é¥°ï¼Œå¢å¼ºèƒ½åŠ›  
            ServerHttpResponseDecorator decoratedResponse = new ServerHttpResponseDecorator(originalResponse) {  
            //ç­‰è°ƒç”¨å®Œè½¬å‘çš„æ¥å£åæ‰ä¼šæ‰§è¡Œ
                @Override  
                public Mono<Void> writeWith(Publisher<? extends DataBuffer> body) {  
                    log.info("body instanceof Flux: {}", (body instanceof Flux));  
                    //å¯¹è±¡æ˜¯å“åº”å¼çš„  
                    if (body instanceof Flux) {  
                        //æˆ‘ä»¬æ‹¿åˆ°çœŸæ­£çš„body  
                        Flux<? extends DataBuffer> fluxBody = Flux.from(body); 
                        //å¾€è¿”å›å€¼é‡Œé¢å†™æ•°æ®  
                        //æ‹¼æ¥å­—ç¬¦ä¸²  
                        return super.writeWith(fluxBody.map(dataBuffer -> { 
                            // 7. TODO è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•° + 1 invokeCount
                            byte[] content = new byte[dataBuffer.readableByteCount()];  
                            dataBuffer.read(content);  
                            DataBufferUtils.release(dataBuffer);//é‡Šæ”¾æ‰å†…å­˜  
                            // æ„å»ºæ—¥å¿—  
                            StringBuilder sb2 = new StringBuilder(200);  
                            sb2.append("<--- {} {} \n");  
                            List<Object> rspArgs = new ArrayList<>();  
                            rspArgs.add(originalResponse.getStatusCode());  
                            //rspArgs.add(requestUrl);  
                            String data = new String(content, StandardCharsets.UTF_8);//data 
                            sb2.append(data);  
                            log.info(sb2.toString(), rspArgs.toArray());//log.info("<-- {} {}\n", originalResponse.getStatusCode(), data);  
                           return bufferFactory.wrap(content);  
                        }));  
                    } else {  
                        // 8. è°ƒç”¨å¤±è´¥ï¼Œfan'huiä¸€ä¸ªè§„èŒƒçš„
                        log.error("<--- {} å“åº”codeå¼‚å¸¸", getStatusCode());  
                    }  
                    return super.writeWith(body);  
                }  
            };  
            //è®¾ç½® response å¯¹è±¡ä¸ºè£…é¥°è¿‡çš„  
            return chain.filter(exchange.mutate().response(decoratedResponse).build());  
        }  
        return chain.filter(exchange);//é™çº§å¤„ç†è¿”å›æ•°æ®  
    }catch (Exception e){
        log.error("gateway log exception.\n" + e);  
        return chain.filter(exchange);
    }
}
```

## Day06 å®Œå–„ç½‘å…³çš„ä¸šåŠ¡é€»è¾‘

### ä»Šæ—¥è®¡åˆ’

1. è¡¥å……å®Œæ•´ç½‘å…³çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ä½•æ“ä½œæ•°æ®åº“?å¦‚ä½•æœç”¨ä¹‹å‰å†™è¿‡çš„æ–¹æ³•ï¼ŸRPCï¼‰
2. å®Œå–„ç³»ç»Ÿçš„TODOå’Œå…¶ä»–åŠŸèƒ½ï¼Œå¹¶å¼€å‘ä¸€ä¸ªç®¡ç†å‘˜çš„ç›‘æ§ç»Ÿè®¡åŠŸèƒ½



### ç½‘å…³ä¸šåŠ¡é€»è¾‘

é—®é¢˜ï¼šä¹‹å‰çš„é¡¹ç›®å·²ç»å†™è¿‡äº†è°ƒç”¨æ•°æ®åº“çš„é‚£äº›mybatisçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¤åˆ¶ç²˜è´´å¤ªéº»çƒ¦

è§£å†³ï¼šç”¨ä¸€ä¸ªå¯ä»¥ç›´æ¥è°ƒç”¨çš„è§£å†³æ–¹æ³•ï¼šRPC



### å¦‚ä½•è°ƒç”¨å…¶ä»–é¡¹ç›®çš„æ–¹æ³•

1. å¤åˆ¶ç²˜è´´ä»£ç å’Œç›¸å…³ä¾èµ–
2. HTTPè¯·æ±‚ï¼ˆæä¾›æ¥å£ï¼Œä¾›å…¶ä»–é¡¹ç›®è¿›è¡Œè°ƒç”¨ï¼‰
3. jaråŒ…è°ƒç”¨
4. æŠŠå…¬å…±ä»£ç è¾¾æˆjaråŒ…ï¼Œå…¶ä»–é¡¹ç›®ç›´æ¥å¼•ç”¨

### HTTPè¯·æ±‚æ€ä¹ˆè°ƒç”¨

1. æä¾›æ–¹å¼€å‘ä¸€ä¸ªæ¥å£ï¼ˆåœ°å€ã€è¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€è¿”å›å€¼ï¼‰
2. è°ƒç”¨æ–¹ä½¿ç”¨`HTTP Client`ä¹‹ç±»çš„ä»£ç å–å‘é€HTTPè¯·æ±‚



### RPCï¼ˆremote produce callï¼‰

**ä½œç”¨ï¼šåƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·å»è°ƒç”¨è¿œç¨‹æ–¹æ³•**

ä¼˜ç‚¹ï¼š

	1. å¯¹å¼€å‘è€…æ›´åŠ é€æ˜ï¼Œå‡å°‘äº†è°ƒç”¨è§çš„æ²Ÿé€šæˆæœ¬
	1. RPCå‘è¿œç¨‹æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæœªå¿…è¦ä½¿ç”¨HTTPåè®®ï¼Œæ¯”å¦‚ï¼šTCP/IPã€æˆ–è€…è‡ªå·±å°è£…çš„åè®®ã€‚ï¼ˆå†…éƒ¨æœåŠ¡æ›´åŠ é€‚ç”¨ï¼‰

### `Feign && RPC`

> Feignåº•å±‚ç”¨çš„HTTPåè®®ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œè°ƒç”¨ï¼Œä½†æ˜¯åŒºåˆ«åœ¨äºFeignåªæ˜¯è®©è¯·æ±‚è¿‡ç¨‹æ›´åŠ ç²¾ç®€,HTTPè¯·æ±‚å…¶å®å¯ä»¥åšåˆ°å’ŒRPCä¸€æ ·çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿˜æœ‰åŒºåˆ«ï¼šRPCå‘è¿œç¨‹æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæœªå¿…è¦ä½¿ç”¨HTTPåè®®ï¼Œæ¯”å¦‚ï¼šTCP/IPã€æˆ–è€…è‡ªå·±å°è£…çš„åè®®ã€‚

HTTPåè®®æ˜¯ä¸€ä¸ª7å±‚åè®®ï¼Œå¦‚æœæƒ³è¦æ¥å£çš„æ€§èƒ½æ›´é«˜ï¼Œå¯ä»¥ä½¿ç”¨TCP/IPåè®®ï¼Œæ›´åŠ åŸç”Ÿçš„åè®®ã€‚

ä¸€èˆ¬æ¥è¯´å¾®æœåŠ¡é¡¹ç›®å†…éƒ¨çš„æ¥å£ï¼Œç”¨`RPC`çš„æ€§èƒ½å¯èƒ½ä¼šæ›´åŠ é«˜ä¸€ç‚¹ï¼Œåè®®å¯é€‰é¡¹æ›´åŠ å¤šä¸€ç‚¹ã€‚

`å·¥ä½œæµç¨‹å›¾ï¼š`

![image-20230729232829504](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307292328515.png)

ğŸ†—ï¼Œç°åœ¨æ¨¡å‹å·²ç»æ­å»ºå¥½äº†ï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡Œå®ç°å‘¢ï¼Ÿä½¿ç”¨Dubboæ¡†æ¶ï¼ˆå¦‚ä½•å­¦ä¹ ï¼Ÿçœ‹å®˜æ–¹æ–‡æ¡£ï¼‰

### Dubboæ¡†æ¶ï¼ˆRPCå®ç°ï¼‰ï¼ˆé˜¿é‡Œå…¬å¸çš„ï¼‰

å…¶å®ƒç±»ä¼¼çš„æ¡†æ¶è¿˜æœ‰`GRPC`ï¼ˆGoogleå…¬å¸çš„ï¼‰ã€`TRPC`ï¼ˆè…¾è®¯å…¬å¸çš„ï¼‰

æœ€å¥½çš„å­¦ä¹ æ–¹å¼ï¼š[é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼](https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/quick-start/spring-boot/)



### ä¸¤ç§ä½¿ç”¨æ–¹å¼

1. Spring Bootä»£ç ï¼ˆæ³¨è§£+ç¼–ç¨‹å¼ï¼‰ï¼šå†™Javaæ¥å£ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…éƒ½å»å¼•ç”¨è¿™ä¸ªæ¥å£ åç¨‹å¯¼

2. IDL(æ¥å£è°ƒç”¨è¯­è¨€)ï¼šåˆ›å»ºä¸€ä¸ªå…¬å…±çš„æ¥å£å®šä¹‰æ–‡ä»¶ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚

   ä¼˜ç‚¹ï¼š

   * è·¨è¯­è¨€ï¼Œæ‰€æœ‰çš„æ¡†æ¶éƒ½è®¤è¯†

   * åº•å±‚æ˜¯Tripleï¼ˆè‡ªå®šä¹‰å°è£…åè®®ï¼Œä¼˜ç‚¹è§[å®˜æ–‡](https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/protocol/triple/)ï¼‰

     ![image-20230730003800623](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307300038465.png)

### ç¤ºä¾‹é¡¹ç›®å­¦ä¹ 

```
git clone -b master https://github.com/apache/dubbo-samples.git
```

zookeeperæ³¨å†Œä¸­å¿ƒï¼šé€šè¿‡å†…åµŒçš„æ–¹å¼è¿è¡Œï¼Œæ›´æ–¹ä¾¿

æœ€å…ˆå¯åŠ¨æ³¨å†Œä¸­å¿ƒï¼Œå…ˆå¯åŠ¨æœåŠ¡æä¾›è€…ï¼Œå†å¯åŠ¨æœåŠ¡æ¶ˆè´¹è€…

### æ•´åˆåº”ç”¨

1. æœåŠ¡æä¾›è€…ï¼šbackend

   a. å®é™…æƒ…å†µåº”è¯¥æ˜¯å»æ•°æ®åº“ä¸­æŸ¥æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·

   b. ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆè¿˜å¯ä»¥æ ¡éªŒè¯·æ±‚å‚æ•°ï¼‰

   c. è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•°+1 invokeCount

2. gatewayé¡¹æ—¥ä½œä¸ºæœåŠ¡è°ƒç”¨è€…ï¼Œè°ƒç”¨è¿™3ä¸ªæ–¹æ³•



> æ•´åˆæ­¥éª¤ï¼š
>
> 1. ä¾èµ–å¼•å…¥  è§†é¢‘äº‹ä»¶ï¼š`00:52`
>
>    ```
>                                                                                                                
>    ```
>
>    
>
> 2. å°†å®˜æ–¹ç¤ºä¾‹ä»£ç ä¸­çš„privideråŒ…ç²˜åˆ°backendä¸­









## Day07 å®Œå–„ç½‘å…³ä¸šåŠ¡ä¸ä¸Šçº¿

### ä»Šæ—¥è®¡åˆ’

1. å®Œå–„ç½‘å…³çš„ä¸šåŠ¡
2. å¼€å‘ç®¡ç†å‘˜çš„åˆ†æåŠŸèƒ½
3. é¡¹ç›®ä¸Šçº¿



### æ•´åˆnacos

> é‡åˆ°ä¸€ä¸ª`nocos`å°BUGï¼š
>
> Dubboæ•´åˆnocosçš„æ—¶å€™ï¼Œæä¾›è€…ä¸æ¶ˆè´¹è€…çš„åŒ…åä¸ä¸€æ ·ï¼Œè¿™æ—¶ï¼Œæä¾›è€…å°†æ¥å£çš„ä¿¡æ¯æ³¨å†Œåˆ°nacosæ–‡æ¡£æ—¶ï¼Œç”¨åˆ°çš„æ˜¯providerçš„åŒ…åè·¯å¾„ï¼Œå¦‚æœå‡ºç°æ¶ˆè´¹è€…çš„åŒ…åè·¯å¾„ä¸æä¾›è€…çš„åŒ…åä¸åŒçš„æ—¶å€™ï¼Œè¿™æ—¶æ¶ˆè´¹è€…å°±ä¼šæŠ¥é”™æ‰¾ä¸åˆ°æä¾›è€…çš„ServiceæœåŠ¡ï¼Œå¦‚å›¾ï¼š
>
> ![image-20230731193204173](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202307311932647.png)



### é‡æ–°æ¢³ç†ç½‘å…³çš„ä¸šåŠ¡é€»è¾‘

1. å®é™…æƒ…å†µåº”è¯¥æ˜¯å»æ•°æ®åº“ä¸­æŸ¥æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·

   a å…ˆæ ¹æ® accessKey åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼ŒæŸ¥åˆ° secretKey
   b å¯¹æ¯” secretKey å’Œç”¨æˆ·ä¼ çš„åŠ å¯†åçš„ secretKey æ˜¯å¦ä¸€è‡´

2. ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠè¯·æ±‚æ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆè¿˜å¯ä»¥æ ¡éªŒè¯·æ±‚å‚æ•°ï¼‰

3. è°ƒç”¨æˆåŠŸï¼Œæ¥å£è°ƒç”¨æ¬¡æ•°+1 invokeCount



### å…¬å…±æœåŠ¡

> ç›®çš„æ˜¯è®©æ–¹æ³•ã€å®ä½“åœ¨å¤šä¸ªé¡¹ç›®ä¸­è¿›è¡Œå¤ç”¨ï¼Œé¿å…é‡å¤ç¼–å†™

* ä¸šåŠ¡åˆ†æ

  * 1. æ•°æ®åº“ä¸­æ˜¯å¦å·²åˆ†é…ç»™ç”¨æˆ·å¯†é’¥ï¼ˆaccesskeyã€secretkeyï¼Œè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å­˜åœ¨ï¼‰âˆš
    2. ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ¨¡æ‹Ÿæ¥å£æ˜¯å¦å­˜åœ¨ï¼ˆè¯·æ±‚è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚å‚æ•°ï¼Œè¿”å›æ¥å£ä¿¡æ¯ï¼Œä¸ºç©ºè¡¨ç¤ºä¸å­˜åœ¨ï¼‰
    3. æ¥å£è°ƒç”¨æ¬¡æ•° + 1 `invokeCount`ï¼ˆakã€skã€è¯·æ±‚æ¥å£è·¯å¾„ï¼‰âˆš




* ä½¿ç”¨æ­¥éª¤ï¼š
  * 1. æ–°å»ºå¹²å‡€çš„ maven é¡¹ç›®ï¼Œåªä¿ç•™å¿…è¦çš„å…¬å…±ä¾èµ–
  
  * 2. æŠ½å– service å’Œå®ä½“ç±»
  
  * 3. install æœ¬åœ° maven åŒ…
  
  * 4. è®©æœåŠ¡æä¾›è€…å¼•å…¥ common åŒ…ï¼Œæµ‹è¯•æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆå‡ºç°Bugï¼ŒbackendåŒ…ä¸­çš„å®ç°ç±»ä¸€ç›´æŠ¥é”™ï¼š
  
       > `'getBaseMapper()' in 'com.baomidou.mybatisplus.extension.service.impl.ServiceImpl' clashes with 'getBaseMapper()' in 'com.baomidou.mybatisplus.extension.service.IService'; attempting to use incompatible return type`
       >
       > åŸå› æ˜¯`UserInterfaceInfoMapper`ç±»ä¸­ï¼Œå¿˜è®°æ›´æ”¹å¼•å…¥çš„å®ä½“ç±»è·¯å¾„ã€‚
       >
       > å°æŠ€å·§ï¼š![image-20230803051309362](https://cdn.jsdelivr.net/gh/wl2o2o/blogCdn/img/202308030513641.png)
       >
       > å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å¿«é€Ÿå®ç°å¤–éƒ¨æä¾›çš„çš„æ¥å£ã€‚
  
  * 5. è®©æœåŠ¡æ¶ˆè´¹è€…å¼•å…¥ common åŒ…

* ä¸šåŠ¡æµç¨‹

  * 1. æ–°å»ºå¹²å‡€çš„ maven é¡¹ç›®ï¼Œåªä¿ç•™å¿…è¦çš„å…¬å…±ä¾èµ–

  * 2. æŠ½å– service å’Œå®ä½“ç±»

  * 3. install æœ¬åœ° maven åŒ…
  
  * 4. è®©æœåŠ¡æä¾›è€…å¼•å…¥ common åŒ…ï¼Œæµ‹è¯•æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ŒåŠ ä¸Š@DubboServiceï¼Œä»¥ä¾¿ä¾›å…¶å®ƒç±»ä½¿ç”¨

    ```java
    // mybatisplusçœŸå¥½ç”¨ï¼ä¸šåŠ¡crudæ‰‹åˆ°æ“’æ¥ï¼
    /**
     * @author WLei224
     * @create 2023/8/3 5:15
     */
    public class InnerInterfaceInfoServiceImpl implements InnerInterfaceInfoService {
        @Resource
        private InterfaceInfoMapper interfaceInfoMapper;
        @Override
        public InterfaceInfo getInterfaceInfo(String url, String method) {
            if (StringUtils.isAnyBlank(url,method)){
                throw new BusinessException(ErrorCode.PARAMS_ERROR);
            }
            QueryWrapper<InterfaceInfo> queryWrapper = new QueryWrapper<>();
            queryWrapper.eq("url",url);
            queryWrapper.eq("method",method);
            return interfaceInfoMapper.selectOne(queryWrapper);
        }
    }
    ```

   * 5. è®©æœåŠ¡æ¶ˆè´¹è€…å¼•å…¥ common åŒ…
  
     > 1. APIç½‘å…³é¡¹ç›®ä¸­å¼•å…¥ common ä¾èµ–
     >
     > 2. ä½¿ç”¨æœåŠ¡æä¾›è€…æä¾›çš„æœåŠ¡ï¼ˆ@DubboServiceå’Œ@DubboReferenceï¼‰
     >
     >    é€šè¿‡@DubboReferenceæ³¨å…¥å…¬å…±æ¨¡å—ä¸­ç¼–å†™å¥½çš„ä¸‰ä¸ªæœåŠ¡
     >
     > 3. å®Œå–„ç½‘å…³ä¸­çš„todoæ ‡ç­¾ï¼Œå®Œå–„ä¸šåŠ¡é€»è¾‘
  
  ### é—®é¢˜
  
  â€‹	é¡¹ç›®è°ƒè¯•ä¸­å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šéœ€è¦æ‰‹åŠ¨å¯¹æ¥å£çš„è°ƒç”¨æ¬¡æ•°è¿›è¡Œåˆ†é…ï¼Œè¿™é‡Œè€ƒè™‘å¯ä»¥å¢åŠ ä¸€ä¸ªç®¡ç†è°ƒç”¨æ¬¡æ•°çš„æ¥å£ã€‚

### ç»Ÿè®¡åˆ†æåŠŸèƒ½

#### éœ€æ±‚

å„ä¸ªæ¥å£çš„æ€»è°ƒç”¨æ¬¡æ•°çš„å æ¯”å›¾ï¼ˆé¥¼å›¾ï¼‰ï¼Œå–è°ƒç”¨æ¬¡æ•°æœ€å¤šçš„ä¸‰ä¸ªæ¥å£ï¼Œä»è€Œè¿›è¡Œåˆ†æå‡ºå“ªä¸ªæ¥å£è¿˜æ²¡æœ‰äººè¿›è¡Œè°ƒç”¨ï¼Œè¿›è€Œå¯¹å…¶é™ä½èµ„æºæˆ–è€…ä¸‹çº¿ï¼Œé«˜é¢‘æ¥å£ï¼ˆå¢åŠ èµ„æºã€æé«˜æ”¶è´¹ï¼‰

#### å®ç°

* **å‰ç«¯**

  * å¼ºçƒˆæ¨èä½¿ç”¨ç°æˆçš„åº“

    * Echartsï¼šhttps://echarts.apache.org/zh/index.htmlï¼ˆæ¨èï¼‰

    * AntVï¼šhttps://antv.vision/zhï¼ˆæ¨èï¼‰

    * BizCharts

    * å¦‚æœæ˜¯ React é¡¹ç›®ï¼Œç”¨è¿™ä¸ªåº“ï¼šhttps://github.com/hustcc/echarts-for-react

    * > æ€ä¹ˆç”¨ï¼Ÿ
      >
      > 1. çœ‹å®˜ç½‘
      > 2. æ‰¾åˆ°å¿«é€Ÿå…¥é—¨ã€æŒ‰æ–‡æ¡£å»å¼•å…¥åº“
      > 3. è¿›å…¥ç¤ºä¾‹é¡µé¢
      > 4. æ‰¾åˆ°ä½ è¦çš„å›¾
      > 5. åœ¨çº¿è°ƒè¯•
      > 6. å¤åˆ¶ä»£ç 
      > 7. æ”¹ä¸ºçœŸå®æ•°æ®

* **åç«¯**

  * å†™ä¸€ä¸ªæ¥å£ï¼Œå¾—åˆ°ä¸‹åˆ—ç¤ºä¾‹æ•°æ®ï¼š
    æ¥å£ Aï¼š2æ¬¡
    æ¥å£ Bï¼š3æ¬¡

  * æ­¥éª¤ï¼š

    1. SQL æŸ¥è¯¢è°ƒç”¨æ•°æ®ï¼š

       ```sql
       select interfaceInfoId, sum(totalNum) as totalNum from user_interface_info group by interfaceInfoId order by totalNum desc limit 3;
       ```

    2. ä¸šåŠ¡å±‚å»å…³è”æŸ¥è¯¢æ¥å£ä¿¡æ¯ã€‚
    
       `controller`:ï¼ˆå°±ä¸å†™Serviceäº†ï¼Œç›´æ¥å†™ä¸šåŠ¡é€»è¾‘ï¼‰
    
       ```java
       /**
        * åˆ†ææ§åˆ¶å™¨
        * @author yupi
        */
       @RestController
       @RequestMapping("/analysis")
       @Slf4j
       public class AnalysisController {
       
           @Resource
           private UserInterfaceInfoMapper userInterfaceInfoMapper;
       
           @Resource
           private InterfaceInfoService interfaceInfoService;
       
           @GetMapping("/top/interface/invoke")
           @AuthCheck(mustRole = "admin")
           public BaseResponse<List<InterfaceInfoVO>> listTopInvokeInterfaceInfo() {
               List<UserInterfaceInfo> userInterfaceInfoList = userInterfaceInfoMapper.listTopInvokeInterfaceInfo(3);
       
               Map<Long, List<UserInterfaceInfo>> interfaceInfoIdObjMap = userInterfaceInfoList.stream()
                       .collect(Collectors.groupingBy(UserInterfaceInfo::getInterfaceInfoId));
       
               QueryWrapper<InterfaceInfo> queryWrapper = new QueryWrapper<>();
               queryWrapper.in("id", interfaceInfoIdObjMap.keySet());
               List<InterfaceInfo> list = interfaceInfoService.list(queryWrapper);
       
               if (CollectionUtils.isEmpty(list)) {
                   throw new BusinessException(ErrorCode.SYSTEM_ERROR);
               }
               List<InterfaceInfoVO> interfaceInfoVOList = list.stream().map(interfaceInfo -> {
                   InterfaceInfoVO interfaceInfoVO = new InterfaceInfoVO();
                   BeanUtils.copyProperties(interfaceInfo, interfaceInfoVO);
                   int totalNum = interfaceInfoIdObjMap.get(interfaceInfo.getId()).get(0).getTotalNum();
                   interfaceInfoVO.setTotalNum(totalNum);
                   return interfaceInfoVO;
               }).collect(Collectors.toList());
               return ResultUtils.success(interfaceInfoVOList);
           }
       }
       ```
    
       `å°è£…ç±»`ï¼š
    
       ```java
       /**
        * æ¥å£ä¿¡æ¯å°è£…è§†å›¾
        * @TableName product
        */
       @EqualsAndHashCode(callSuper = true)
       @Data
       public class InterfaceInfoVO extends InterfaceInfo {
       
           /**
            * è°ƒç”¨æ¬¡æ•°
            */
           private Integer totalNum;
       
           private static final long serialVersionUID = 1L;
       }
       ```
    
       `UserInterfaceInfoMapper`:
    
       ```java
       /**
        * @Entity com.wl.smartapicommon.model.entity.UserInterfaceInfo
        */
       public interface UserInterfaceInfoMapper extends BaseMapper<UserInterfaceInfo> {
       
           // è·å–å‰å‡ ä¸ªè°ƒç”¨æ¬¡æ•°æœ€å¤šçš„æ¥å£
           List<UserInterfaceInfo> listTopInvokeInterfaceInfo(int limit);
       
       }
       ```
    
       `xmlä¸­æ·»åŠ sqlè¯­å¥`ï¼š
    
       ```xml
       <select id="listTopInvokeInterfaceInfo" resultType="com.wl.smartapicommon.model.entity.UserInterfaceInfo">
           select interfaceInfoId, sum(totalNum) as totalNum
           from user_interface_info
           group by interfaceInfoId
           order by totalNum
           desc limit #{limit};
       </select>
       ```
    

## ä¸Šçº¿è®¡åˆ’

* å‰ç«¯ï¼šå‚è€ƒä¹‹å‰ç”¨æˆ·ä¸­å¿ƒæˆ–ä¼™ä¼´åŒ¹é…ç³»ç»Ÿçš„ä¸Šçº¿æ–¹å¼
* åç«¯ï¼š
  * backend é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆå¯¹å¤–çš„ï¼‰
  * gateway ç½‘å…³é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆå¯¹å¤–çš„ï¼‰
  * interface æ¨¡æ‹Ÿæ¥å£é¡¹ç›®ï¼šweb é¡¹ç›®ï¼Œéƒ¨ç½² spring boot çš„ jar åŒ…ï¼ˆä¸å»ºè®®å¯¹å¤–æš´éœ²çš„ï¼‰

***å…³é”®ï¼šç½‘ç»œå¿…é¡»è¦è¿é€š***

>å¦‚æœè‡ªå·±å­¦ä¹ ç”¨ï¼šå•ä¸ªæœåŠ¡å™¨éƒ¨ç½²è¿™ä¸‰ä¸ªé¡¹ç›®å°±è¶³å¤Ÿã€‚
>å¦‚æœä½ æ˜¯æå¤§äº‹ï¼Œå¤šä¸ªæœåŠ¡å™¨å»ºè®®åœ¨ åŒä¸€å†…ç½‘ ï¼Œå†…ç½‘äº¤äº’ä¼šæ›´å¿«ã€ä¸”æ›´å®‰å…¨ã€‚



#### ä¸Šçº¿ç¯å¢ƒå‡†å¤‡

1. dockerå®‰è£…

   ```shell
   curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
   systemctl start docker 
   systemctl enable docker
   systenctl restart docker
   ```

2. å®å¡”é¢æ¿

   ```shell
   # å®‰è£…å‘½ä»¤
   yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh
   # å¸è½½å‘½ä»¤
   systemct stop bt
   rm -rf /www/server/panel
   rm -f /etc/init.d/bt
   
   rm -rf /root/.pyenv/versions/3.7.0/envs/btpanel/lib/python3.7/site-packages/pycache
   rm -rf /root/.pyenv/versions/3.7.0/envs/btpanel/lib/python3.7/site-packages/btpanel/__pycache__
   rm -rf /root/.pyenv/versions/3.7.0/envs/btpanel/lib/python3.7/site-packages/panelApp/__pycache__
   
   rm -rf /www/server/panel/logs/*
   ```

3. [Docker å®‰è£… Nginx](https://blog.csdn.net/u010148813/article/details/126172372)

   ```shell
   # æ‹‰å–å®˜æ–¹çš„æœ€æ–°ç‰ˆæœ¬çš„é•œåƒ
   $ docker pull nginx
   
   # ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œ nginx å®¹å™¨
   $ docker run --name nginx -p 80:80 -d nginx
   
   # åœ¨å®¿ä¸»æœºå®¶ç›®å½•åˆ›å»ºç”¨äºæ”¾é…ç½®æ–‡ä»¶çš„æ–‡ä»¶å¤¹
   $ mkdir -p /root/docker-nginx/{conf,html,logs}
   
   # ä»å®¹å™¨nginxä¸­å¤åˆ¶nginx.confæ–‡ä»¶åˆ°å®¿ä¸»æœº
   $ docker cp nginx:/etc/nginx/nginx.conf /root/docker-nginx       
   $ docker cp nginx:/etc/nginx/conf.d/default.conf /root/docker-nginx/conf/
   $ docker cp nginx:/usr/share/nginx/html/ /root/docker-nginx/
   
   
   ----------------------------------------------
   è¯´æ˜ï¼š
   å®¿ä¸»æœºï¼šå°±æ˜¯ä½ çš„äº‘æœåŠ¡å™¨æˆ–è€…è™šæ‹Ÿæœºã€‚
   ~ ç›®å½•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å®¶ç›®å½•/home/your_username.(å¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼Œä¸”æ²¡æœ‰åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œé‚£ä¹ˆå®¶ç›®å½•å°±æ˜¯ /root äº†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„ç®¡ç†å‘˜ç”¨æˆ·ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™ï¼Œæ‰€ä»¥å‘½ä»¤å°±ä¸ç”¨åŠ ä¸Š sudo äº†)
   
   åˆšæ‰çš„æ“ä½œæ˜¯æŠŠä½ åœ¨dockerä¸­æ‹‰å–çš„ Nginx çš„é•œåƒé…ç½®æ–‡ä»¶å¤åˆ¶äº†ä¸€ä»½åˆ°å®¶ç›®å½•ï¼Œè¿™æ ·å¯ä»¥ä¾¿äºåç»­å¯¹ nginx çš„é…ç½®ï¼Œsay Why?ï¼Œå› ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šé€šè¿‡æ˜ å°„ï¼Œå°†æˆ‘ä»¬å¤åˆ¶åˆ°å®¿ä¸»æœºçš„é…ç½®æ–‡ä»¶ç›´æ¥æ˜ å°„åˆ° docker å®¹å™¨ä¸­çš„ Nginx ä¸­ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œä¸‹æ¬¡è‹¥éœ€è¦é…ç½®ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨å®¿ä¸»æœºä¸­è¿›è¡Œé…ç½®äº†ï¼Œå¦åˆ™è¿˜éœ€è¦é€šè¿‡ `$ docker exec -it nginx bash` å‘½ä»¤è¿›å…¥åˆ° Nginx çš„é•œåƒä¹‹ä¸­ã€‚
   ```
   
   
   
   - æ‰“åŒ…ä¸€ä¸‹å¤åˆ¶å¥½çš„é…ç½®æ–‡ä»¶ï¼ˆå¤‡ä»½ï¼Œä»¥å…æ“ä½œå¤±è¯¯å¯è¡¥æ•‘ï¼‰
   
   ```shell
   # åˆ æ‰ nginx å®¹å™¨
   $ docker stop nginx
   $ docker rm nginx
   
   # é‡æ–°è¿è¡Œå®¹å™¨ï¼Œå¹¶åŠ ä¸Šé…ç½®æ–‡ä»¶çš„æ˜ å°„
   $ docker run -p 80:80 \
   -v /root/docker-nginx/nginx.conf:/etc/nginx/nginx.conf \
   -v /root/docker-nginx/logs:/var/log/nginx \
   -v /root/docker-nginx/html:/usr/share/nginx/html \
   -v /root/docker-nginx/conf:/etc/nginx/conf.d \
   --name nginx \
   --privileged=true \
   --restart=always \
   -d nginx
   
   ----------------------------------------------
   ç»ˆäºå®Œæˆï¼å¦‚é‡åˆ°403æˆ–è€…æ— æ³•è®¿é—®æ­¤ç½‘ç«™ç­‰å…¶ä»–é—®é¢˜ï¼Œé¦–å…ˆå»ä½ è´­ä¹°çš„äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„æ–°å¢ 80 ç«¯å£ï¼Œå¦‚æœä½ å¼€äº†ä»£ç†ï¼Œè¯•ç€é‡å¯æˆ–è€…æ³¨é”€ç”µè„‘ã€‚
   å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/l123lgx/article/details/122619851
   
   server {
       listen 80;
       server_name localhost;
       #charset koi8-r;
       #access_log logs/host.access.log main;
       location / {
           root html;
           index index.html index.htm;
   	}
       #error_page 404 /404.html;
       # redirect server error pages to the static page /50x.html
       #
       error_page 500 502 503 504 /50x.html;
       location = /50x.html {
       	root html;
       }
       # proxy the PHP scripts to Apache listening on 127.0.0.1:80
       #
       #location ~ \.php$ {
       # proxy_pass http://127.0.0.1;
       #}
       # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
       #
       #location ~ \.php$ {
       # root html;
       # fastcgi_pass 127.0.0.1:9000;
       # fastcgi_index index.php;
       # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;
       # include fastcgi_params;
       #}
       # deny access to .htaccess files, if Apache's document root
       # concurs with nginx's one
       #
       #location ~ /\.ht {
       # deny all;
       #}
   }
       # another virtual host using mix of IP-, name-, and port-based configuration
       #
       #server {
       # listen 8000;
       # listen somename:8080;
       # server_name somename alias another.alias;
       # location / {
       # root html;
       # index index.html index.htm;
       # }
       #}
       # HTTPS server
       #
       #server {
       # listen 443 ssl;
       # server_name localhost;
       # ssl_certificate cert.pem;
       # ssl_certificate_key cert.key;
       # ssl_session_cache shared:SSL:1m;
       # ssl_session_timeout 5m;
       # ssl_ciphers HIGH:!aNULL:!MD5;
       # ssl_prefer_server_ciphers on;
       # location / {
       # root html;
       # index index.html index.htm;
       # }
       #}
   
   ```
   
   å¤ä¹ ä¸€ä¸‹`tar`å‘½ä»¤çš„ç”¨æ³•ï¼š
   
   <img src="https://cs-wlei224.obs.cn-south-1.myhuaweicloud.com/blog-imgs/202308260050797.png" alt="image-20230826005051120" style="zoom:50%;" />
   
   è§£å‹çš„è¯äº¦æ˜¯åŒç†ï¼š
   
   > è§£å‹ tar å­˜æ¡£æ–‡ä»¶çš„å¸¸ç”¨å‘½ä»¤æ˜¯ `tar -xzvf`ã€‚ä¸‹é¢æ˜¯å¯¹è¿™äº›å‚æ•°çš„è§£é‡Šï¼š
   >
   > - `-x`ï¼šè¡¨ç¤ºä»å­˜æ¡£æ–‡ä»¶ä¸­æå–ï¼ˆè§£å‹ï¼‰æ–‡ä»¶ã€‚
   > - `-z`ï¼šè¡¨ç¤ºä½¿ç”¨ gzip å‹ç¼©ç®—æ³•è¿›è¡Œè§£å‹ç¼©ã€‚ä½¿ç”¨æ­¤å‚æ•°å¯ä»¥è§£å‹è¢« gzip å‹ç¼©çš„ tar å­˜æ¡£æ–‡ä»¶ã€‚
   > - `-v`ï¼šè¡¨ç¤ºåœ¨å‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œå³æ˜¾ç¤ºæå–çš„æ–‡ä»¶åˆ—è¡¨ã€‚
   > - `-f`ï¼šæŒ‡å®šè¦æå–çš„å­˜æ¡£æ–‡ä»¶çš„åç§°ã€‚ç´§è·Ÿåœ¨ `-f` å‚æ•°åé¢çš„æ˜¯å­˜æ¡£æ–‡ä»¶çš„åç§°ã€‚
   
   4. `docker`å®‰è£…`MySQL`
   
      ```shell
      docker pull mysql
      
      # åœ¨å®¿ä¸»æœºå®¶ç›®å½•åˆ›å»ºç”¨äºæ”¾é…ç½®æ–‡ä»¶çš„æ–‡ä»¶å¤¹
      $ mkdir -p /root/docker-mysql/{conf,data,log}
      
      # åœ¨é…ç½®æ–‡ä»¶ç›®å½•:/root/docker-mysql/confæ–°å»ºä¸€ä¸ªmy.cnfé…ç½®æ–‡ä»¶ï¼Œå†™å…¥ä¸‹é¢å†…å®¹ï¼Œè®¾ç½®å®¢æˆ·ç«¯å’ŒmysqlæœåŠ¡å™¨ç«¯ç¼–ç éƒ½ä¸ºutf8
      [client]
      default_character_set=utf8
      [mysqld]
      collation_server=utf8_general_ci
      character_set_server=utf8
      
      docker run -p 3306:3306 \
      --privileged=true \
      -v /root/docker-mysql/log:/var/log/mysql \
      -v /root/docker-mysql/data:/var/lib/mysql \
      -v /root/docker-mysql/conf:/etc/mysql/conf.d \
      -e MYSQL_ROOT_PASSWORD=ä½ çš„MySQLå¯†ç  \
      --name mysql \
      -d mysql
      
      docker exec -it mysql bash
      
      mysql -u root -p
      
      å¦‚æœé‡åˆ°`Navicat`è¿æ¥ä¸ä¸Šçš„é—®é¢˜ï¼Œè¯·çœ‹ä¸‹é¢çš„é“¾æ¥ã€‚
      ```
   
      è®°å½•ä¸€ä¸ªå¤§å‘ï¼Œå®å¡”é¢æ¿æ·»åŠ 3306ç«¯å£å·ï¼Œè¢«è…¾è®¯äº‘æœåŠ¡å™¨æ‹¦æˆªäº†ï¼Œæ— è¯­äº†ï¼Œè¿˜æ˜¯é€šè¿‡äº‘æœåŠ¡å™¨æ§åˆ¶å°ï¼ˆæ¨èâœ¨ï¼‰æˆ–è€…é˜²ç«å¢™å‘½ä»¤æ¥æ·»åŠ ç«¯å£å§ã€‚
   
      å‚è€ƒé“¾æ¥ï¼šhttps://www.cnblogs.com/--eric/p/17145834.html
   
   
   
   5. `JDK`å®‰è£…
   
      ```shell
      # yum å®‰è£…å…ç¯å¢ƒå˜é‡çš„é…ç½®
      $ yum install -y java-1.8.0-openjdk*
      ```
   
   6. `maven`å®‰è£…
   
      ```shell
      é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–å®‰è£…åŒ…æˆ–è€…é€šè¿‡æœ¬åœ°æµè§ˆå™¨ä¸‹è½½åˆ°ä¸»æœºï¼Œç„¶åé€šè¿‡ ftp ä¼ è¾“åˆ° Linux æœåŠ¡å™¨
      curl -O https://dlcdn.apache.org/maven/maven-3/3.8.8/binaries/apache-maven-3.8.8-bin.tar.gz
      
      tar -zxvf apache-maven-3.8.8-bin.tar.gz
      
      vim /etc/profile
      
      æ–‡ä»¶ç©ºç™½å¤„å¢åŠ ä¸¤è¡Œå†…å®¹ï¼š
      export MAVEN_HOME=/root/services/apache-maven-3.8.8
      export PATH=$MAVEN_HOME/bin:$PATH
      
      source /etc/profile
      
      mvn --version
      
      ```
   
      
   
   7. `redis`å®‰è£…
   
      ```shell
      docker pull redis
      
      mkdir -p /root/docker-redis/conf
      
      # å…¥redisé…ç½®æ–‡ä»¶å¤¹
      cd /root/docker-redis/conf  
      
      # ä¸‹è½½redisé…ç½®æ–‡ä»¶
      wget http://download.redis.io/redis-stable/redis.conf   
      
      vim redis.conf  // ä¿®æ”¹é…ç½®æ–‡ä»¶
      1. appendonly yes    å¯åŠ¨RedisæŒä¹…åŒ–åŠŸèƒ½ (é»˜è®¤ no , æ‰€æœ‰ä¿¡æ¯éƒ½å­˜å‚¨åœ¨å†…å­˜ [é‡å¯ä¸¢å¤±] ã€‚è®¾ç½®ä¸º yes , å°†å­˜å‚¨åœ¨ç¡¬ç›˜ [é‡å¯è¿˜åœ¨])
      2. protected-mode no    å…³é—­protected-modeæ¨¡å¼ï¼Œæ­¤æ—¶å¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®
      3. bind 0.0.0.0    è®¾ç½®æ‰€æœ‰IPéƒ½å¯ä»¥è®¿é—®
      4. requirepass å¯†ç     è®¾ç½®å¯†ç 
      å¦‚æœä½ è®¾ç½®äº†å¯†ç ,éœ€è¦é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›å…¥Redisæ§åˆ¶å°
      ## è¿›å…¥Rediså®¹å™¨
              docker exec -it redis bash
      ## é€šè¿‡å¯†ç è¿›å…¥Redisæ§åˆ¶å°
              redis-cli -h 127.0.0.1 -p 6379 -a [ä½ çš„å¯†ç ]
              
      mkdir -p /root/docker-redis/data
      
      docker run -p 6379:6379 \
      -v /root/docker-redis/conf/redis.conf:/etc/redis/redis.conf \
      -v /root/docker-redis/data:/data \
      -e REDIS_ROOT_PASSWORD=ä½ çš„Rediså¯†ç  \
      --restart=always \
      --name redis \
      -d redis
      
      
      ä¸è¦å¿˜è®°æ‰“å¼€é˜²ç«å¢™6379ç«¯å£ï¼Œé€šè¿‡å®å¡”é¢æ¿æˆ–è€…å‘½ä»¤ï¼Œæˆ–è€…äº‘æœåŠ¡å™¨æ§åˆ¶å°
      ```
   
      
   
   8. `nacos`å®‰è£…
   
      ```shell
      docker pull nacos/nacos-server
      
      # åœ¨å®¿ä¸»æœºå®¶ç›®å½•åˆ›å»ºç”¨äºæ”¾é…ç½®æ–‡ä»¶çš„æ–‡ä»¶å¤¹
      $ mkdir -p /root/docker-nacos/nacos/{init.d,logs}
      
      vim /root/docker-nacos/nacos/init.d/application.properties 
      
      server.contextPath=/nacos
      server.servlet.contextPath=/nacos
      server.port=8848
       
      spring.datasource.platform=mysql
      db.num=1
      db.url.0=jdbc:mysql://xx.xx.xx.x:3306/nacos_devtest_prod?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true
      db.user=user
      db.password=pass
       
      nacos.cmdb.dumpTaskInterval=3600
      nacos.cmdb.eventTaskInterval=10
      nacos.cmdb.labelTaskInterval=300
      nacos.cmdb.loadDataAtStart=false
      management.metrics.export.elastic.enabled=false
      management.metrics.export.influx.enabled=false
      server.tomcat.accesslog.enabled=true
      server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D %{User-Agent}i
      nacos.security.ignore.urls=/,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/login,/v1/console/health/**,/v1/cs/**,/v1/ns/**,/v1/cmdb/**,/actuator/**,/v1/console/server/**
      nacos.naming.distro.taskDispatchThreadCount=1
      nacos.naming.distro.taskDispatchPeriod=200
      nacos.naming.distro.batchSyncKeyCount=1000
      nacos.naming.distro.initDataRatio=0.9
      nacos.naming.distro.syncRetryDelay=5000
      nacos.naming.data.warmup=true
      nacos.naming.expireInstance=true
      
      
      docker run -p 8848:8848 \
      -e JVM_XMS=256m \
      -e JVM_XMX=256m \
      -e MODE=standalone \
      -e PREFER_HOST_MODE=hostname \
      -v /root/docker-nacos/nacos/logs:/home/nacos/logs \
      -v /root/docker-nacos/nacos/init.d/application.properties:/home/nacos/init.d/application.properties \
      --name nacos \
      --privileged=true \
      --restart=always \
      -d nacos/nacos-server
      ```
   
      å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/yexiaomodemo/article/details/123355202
   
      
   
   9. `rabbitmq`å®‰è£…
   
      ```shell
      docker pull rabbitmq
      
      docker run -p 5672:5672 -p 15672:15672 \
      -v /root/docker-rabbitmq/config/:/etc/rabbitmq/ \
      -e RABBITMQ_DEFAULT_USER=admin \
      -e RABBITMQ_DEFAULT_PASS=admin \
      --hostname myRabbit \
      --name rabbitmq \
      --restart=always \
      -d rabbitmq
      
      docker exec -it rabbitmq bash
      
      # å¯åŠ¨å¯è§†åŒ–æ’ä»¶
      rabbitmq-plugins enable rabbitmq_management
      
      ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€webç®¡ç†ç«¯ï¼šhttp://Server-IP:15672 
      ```
   

  	å‚è€ƒé“¾æ¥ï¼š

â€‹	  https://blog.csdn.net/qq_42977003/article/details/128107521
â€‹	  https://blog.csdn.net/feritylamb/article/details/128434465

#### ä¸€ã€åŸå§‹éƒ¨ç½²

â€‹	ç¼ºç‚¹ï¼šéœ€è¦ä¸€ä¸ªä¸ªé…ç½®ç¯å¢ƒï¼Œå®‰è£…å¿…é¡»è½¯ä»¶

#### äºŒã€å®å¡”é¢æ¿éƒ¨ç½²

â€‹	ä¼˜ç‚¹ï¼šå¯è§†åŒ–å®‰è£…ä¸é…ç½®

#### ä¸‰ã€dockeréƒ¨ç½²

> Dockeræ˜¯ä¸€ç§å¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œç”¨äºæ„å»ºã€å‘å¸ƒå’Œè¿è¡Œåº”ç”¨ç¨‹åºã€‚é€šè¿‡ä½¿ç”¨Dockerï¼Œæ‚¨å¯ä»¥å°†åº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–é¡¹æ‰“åŒ…åˆ°ä¸€ä¸ªç§°ä¸ºå®¹å™¨çš„ç‹¬ç«‹å•å…ƒä¸­ï¼Œä»¥ä¾¿åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œï¼Œè€Œæ— éœ€æ‹…å¿ƒç¯å¢ƒå·®å¼‚æˆ–ä¾èµ–é—®é¢˜ã€‚
>
> ä»¥ä¸‹æ˜¯ä¸€äº›ä¸Dockerç›¸å…³çš„å¸¸ç”¨æ¦‚å¿µå’Œå‘½ä»¤ï¼š
>
> 1. é•œåƒï¼ˆImageï¼‰ï¼šé•œåƒæ˜¯Dockerå®¹å™¨çš„åŸºç¡€ï¼Œå®ƒåŒ…å«äº†è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¸€åˆ‡ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ç¯å¢ƒã€åº“å’Œä¾èµ–é¡¹ã€‚æ‚¨å¯ä»¥é€šè¿‡æ„å»ºè‡ªå®šä¹‰é•œåƒæˆ–ä»Docker Hubç­‰é•œåƒä»“åº“ä¸­è·å–ç°æœ‰çš„é•œåƒã€‚
> 2. å®¹å™¨ï¼ˆContainerï¼‰ï¼šå®¹å™¨æ˜¯åŸºäºé•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹ã€éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒã€‚å®¹å™¨å¯ä»¥å¯åŠ¨ã€åœæ­¢ã€é‡å¯å’Œåˆ é™¤ï¼Œæ¯ä¸ªå®¹å™¨éƒ½å…·æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç©ºé—´å’Œç½‘ç»œæ¥å£ã€‚
> 3. Dockerfileï¼šDockerfileæ˜¯ç”¨äºå®šä¹‰é•œåƒæ„å»ºè¿‡ç¨‹çš„æ–‡æœ¬æ–‡ä»¶ã€‚å®ƒåŒ…å«ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨äºæŒ‡å®šåŸºç¡€é•œåƒã€å®‰è£…è½¯ä»¶ã€å¤åˆ¶æ–‡ä»¶ã€è®¾ç½®ç¯å¢ƒå˜é‡ç­‰ã€‚
> 4. Docker Composeï¼šDocker Composeæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šä¸ªå®¹å™¨åº”ç”¨çš„å·¥å…·ã€‚å®ƒä½¿ç”¨ä¸€ä¸ªYAMLæ–‡ä»¶æ¥å®šä¹‰å„ä¸ªæœåŠ¡åŠå…¶ä¾èµ–å…³ç³»ï¼Œå¹¶å¯ä»¥ä¸€é”®å¯åŠ¨ã€åœæ­¢å’Œç®¡ç†æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å®¹å™¨ç¾¤ã€‚
>
> ä¸€äº›å¸¸ç”¨çš„Dockerå‘½ä»¤åŒ…æ‹¬ï¼š
>
> - `docker build`ï¼šæ ¹æ®Dockerfileæ„å»ºé•œåƒã€‚
> - `docker run`ï¼šåˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚
> - `docker stop`ï¼šåœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚
> - `docker start`ï¼šå¯åŠ¨å·²ç»åœæ­¢çš„å®¹å™¨ã€‚
> - `docker rm`ï¼šåˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚
> - `docker images`ï¼šåˆ—å‡ºæœ¬åœ°å·²ä¸‹è½½çš„é•œåƒã€‚
> - `docker pull`ï¼šä»é•œåƒä»“åº“ä¸‹è½½é•œåƒã€‚
> - `docker push`ï¼šå°†æœ¬åœ°é•œåƒæ¨é€åˆ°é•œåƒä»“åº“ã€‚
>
> è¿™åªæ˜¯Dockerçš„ä¸€å°éƒ¨åˆ†åŠŸèƒ½å’Œå‘½ä»¤ï¼ŒDockerè¿˜æä¾›äº†è®¸å¤šå…¶ä»–åŠŸèƒ½ï¼Œå¦‚ç½‘ç»œé…ç½®ã€æ•°æ®å·ã€å®¹å™¨ç¼–æ’ç­‰ã€‚å¦‚æœæ‚¨æƒ³æ›´æ·±å…¥äº†è§£Dockerçš„ä½¿ç”¨ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£æˆ–ç›¸å…³æ•™ç¨‹ã€‚
>
> 
>
> dockerå¦‚ä½•æ‰“åŒ…ä¸€ä¸ªé•œåƒï¼Œå‘½ä»¤æ˜¯ä»€ä¹ˆ?
>
> 
>
> è¦æ‰“åŒ…ä¸€ä¸ªDockeré•œåƒï¼Œæ‚¨éœ€è¦ç¼–å†™ä¸€ä¸ªDockerfileï¼Œå…¶ä¸­åŒ…å«æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œé…ç½®ã€‚ç„¶åï¼Œä½¿ç”¨`docker build`å‘½ä»¤æ¥æ„å»ºé•œåƒã€‚ä»¥ä¸‹æ˜¯åŸºæœ¬çš„æ­¥éª¤å’Œç›¸åº”çš„å‘½ä»¤ï¼š
>
> 1. åˆ›å»ºä¸€ä¸ªDockerfileï¼šåœ¨æ‚¨çš„é¡¹ç›®ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`Dockerfile`çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¹¶ç¼–è¾‘å®ƒã€‚
>
> 2. åœ¨Dockerfileä¸­å®šä¹‰é•œåƒæ„å»ºè¿‡ç¨‹ï¼šDockerfileåŒ…å«ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨äºæŒ‡å®šåŸºç¡€é•œåƒã€å®‰è£…è½¯ä»¶ã€å¤åˆ¶æ–‡ä»¶ã€è®¾ç½®ç¯å¢ƒå˜é‡ç­‰ã€‚æ ¹æ®æ‚¨çš„åº”ç”¨ç¨‹åºéœ€æ±‚ï¼Œç¼–å†™é€‚å½“çš„æŒ‡ä»¤ã€‚
>
>    ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„Dockerfileç¤ºä¾‹ï¼š
>
>    ```dockerfile
>    # ä½¿ç”¨å®˜æ–¹çš„ Node.js ä½œä¸ºåŸºç¡€é•œåƒ
>    FROM node:14
>
>    # è®¾ç½®å·¥ä½œç›®å½•
>    WORKDIR /app
>
>    # å¤åˆ¶åº”ç”¨ç¨‹åºä»£ç åˆ°å®¹å™¨ä¸­
>    COPY . .
>
>    # å®‰è£…åº”ç”¨ç¨‹åºä¾èµ–
>    RUN npm install
>
>    # æš´éœ²åº”ç”¨ç¨‹åºçš„ç«¯å£
>    EXPOSE 3000
>
>    # å®šä¹‰å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œçš„å‘½ä»¤
>    CMD ["npm", "start"]
>
>    è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å®˜æ–¹çš„Node.js 14é•œåƒä½œä¸ºåŸºç¡€é•œåƒï¼Œå°†åº”ç”¨ç¨‹åºä»£ç å¤åˆ¶åˆ°å®¹å™¨ä¸­ï¼Œå®‰è£…ä¾èµ–é¡¹ï¼Œæš´éœ²ç«¯å£3000ï¼Œå¹¶åœ¨å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œ`npm start`å‘½ä»¤ã€‚
>    ```
>
> 3. æ„å»ºé•œåƒï¼šåœ¨ç»ˆç«¯ä¸­ï¼Œåˆ‡æ¢åˆ°åŒ…å«Dockerfileçš„ç›®å½•ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»ºé•œåƒï¼š
>
>    ```
>    docker build -t image_name:tag .
>    ```
>
>    - `-t`å‚æ•°ç”¨äºæŒ‡å®šé•œåƒçš„åç§°å’Œæ ‡ç­¾ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰åç§°å’Œæ ‡ç­¾ã€‚
>    - `.`è¡¨ç¤ºDockerfileæ‰€åœ¨çš„å½“å‰ç›®å½•ã€‚ç¡®ä¿åœ¨è¿è¡Œå‘½ä»¤ä¹‹å‰ï¼Œæ‚¨å·²ç»åˆ‡æ¢åˆ°æ­£ç¡®çš„ç›®å½•ã€‚
>
>    ä¾‹å¦‚ï¼Œè¦æ„å»ºä¸€ä¸ªåä¸º`myapp`çš„é•œåƒï¼Œæ ‡ç­¾ä¸º`v1.0`ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
>
>    ```
>    docker build -t myapp:v1.0 .
>    ```
>
> 4. ç­‰å¾…æ„å»ºå®Œæˆï¼šDockerå°†æ‰§è¡ŒDockerfileä¸­çš„æ¯ä¸ªæŒ‡ä»¤ï¼Œå¹¶æ„å»ºé•œåƒã€‚è¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå–å†³äºæ‚¨çš„é•œåƒå¤§å°å’Œå¤æ‚æ€§ã€‚
>
> 5. æŸ¥çœ‹æ„å»ºçš„é•œåƒï¼šæ„å»ºå®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æœ¬åœ°çš„é•œåƒåˆ—è¡¨ï¼š
>
>    ```
>    docker images
>    ```
>
>    æ‚¨å°†çœ‹åˆ°åˆšåˆšæ„å»ºçš„é•œåƒä»¥åŠå…¶åç§°ã€æ ‡ç­¾å’Œå¤§å°ç­‰ä¿¡æ¯ã€‚
>
> é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨Dockerfileå’Œ`docker build`å‘½ä»¤æ¥æ‰“åŒ…æ„å»ºè‡ªå·±çš„Dockeré•œåƒã€‚è¯·æ ¹æ®æ‚¨çš„åº”ç”¨ç¨‹åºéœ€æ±‚å’Œç¯å¢ƒé…ç½®é€‚å½“åœ°ç¼–è¾‘Dockerfileã€‚

##### å‰ç«¯éƒ¨ç½²ä¾‹å­ï¼š

`dockerfile`æ–‡ä»¶ï¼š

```dockerfile
FROM nginx

WORKDIR /usr/share/nginx/html/
USER root

COPY ./docker/nginx.conf /etc/nginx/conf.d/default.conf

COPY ./dist  /usr/share/nginx/html/

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

`nginx.conf`æ–‡ä»¶ï¼š

```nginx
server {
    listen 80;

    # gzip config
    gzip on;
    gzip_min_length 1k;
    gzip_comp_level 9;
    gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml;
    gzip_vary on;
    gzip_disable "MSIE [1-6]\.";

    root /usr/share/nginx/html;
    include /etc/nginx/mime.types;

    location / {
        try_files $uri /index.html;
    }

}
```



### é¡¹ç›®æ‰©å±•æ€è·¯

1. ç”¨æˆ·è‡ªå·±å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å

2. æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿèƒ½ä¸Šä¼ æ¥å£ï¼Ÿ

   > * éœ€è¦æä¾›ä¸€ä¸ªæœºåˆ¶ï¼ˆä¸€ä¸ªé¡µé¢ï¼‰ï¼Œè®©ç”¨æˆ·æ¥è¾“å…¥è‡ªå·±çš„æ¥å£hostï¼ˆéƒ½æ­¦å™¨çš„åœ°å€ï¼‰ã€æ¥å£ä¿¡æ¯ã€å°†æ¥å£å†™å…¥æ•°æ®åº“ï¼›
   > * å¯ä»¥åœ¨interfaceInfoè¡¨ä¸­åŠ ä¸ªhostå­—æ®µï¼Œä»¥æ¬¡åŒºåˆ†æœåŠ¡å™¨åœ°å€ï¼Œè®©æ¥å£æä¾›è€…æ›´çµæ´»çš„æ¥å…¥ç³»ç»Ÿï¼›
   > * å°†æ¥å£ä¿¡æ¯å…¥åº“å‰ï¼Œè¦å¯¹æ¥å£è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚æ£€æŸ¥åœ°å€æ˜¯å¦éµå¾ªè§„åˆ™ã€æ˜¯å¦å¯ä»¥æ­£å¸¸è°ƒç”¨,å¹¶éµå¾ªç”²æ–¹è¦æ±‚ï¼ˆä½¿ç”¨SDKï¼‰

3. ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•°

   éœ€è¦è€ƒè™‘å¹¶å‘çš„é—®é¢˜ï¼Œé˜²æ­¢ç¬é—´è°ƒç”¨è¶…é¢‘ã€‚

4. ç½‘å…³ä¼˜åŒ–

   æ¯”å¦‚å¢åŠ é™æµã€é™çº§ä¿æŠ¤ã€æé«˜æ€§èƒ½ç­‰ã€‚è¿˜å¯ä»¥è€ƒè™‘æ­é…Nginxç½‘å…³ä½¿ç”¨ã€‚

5. åŠŸèƒ½å¢å¼º

   å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¯·æ±‚å¤´æˆ–è€…æ¥å£ç±»å‹æ¥è®¾è®¡å‰ç«¯ç•Œé¢å’Œè¡¨å•ï¼Œç™¾å¹´ä¸ç”¨æˆ·è¿›è¡Œè°ƒç”¨ï¼Œå¢å¼ºä½“éªŒã€‚

   ï¼ˆå¯ä»¥å‚è€ƒswaggerã€postmanã€kniffjçš„ç•Œé¢ï¼‰



## é¡¹ç›®ä¼˜åŒ–

### æ‰©å±•æ€è·¯

 1. ç”¨æˆ·å¯ä»¥ç”³è¯·æ›´æ¢ç­¾å
 2. æ€ä¹ˆè®©å…¶ä»–ç”¨æˆ·ä¹Ÿä¸Šä¼ æ¥å£ï¼Ÿ 
éœ€è¦æä¾›ä¸€ä¸ªæœºåˆ¶ï¼ˆç•Œé¢ï¼‰ï¼Œè®©ç”¨æˆ·è¾“å…¥è‡ªå·±çš„æ¥å£ hostï¼ˆæœåŠ¡å™¨åœ°å€ï¼‰ã€æ¥å£ä¿¡æ¯ï¼Œå°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ã€‚
å¯ä»¥åœ¨ interfaceInfo è¡¨é‡ŒåŠ ä¸ª host å­—æ®µï¼ŒåŒºåˆ†æœåŠ¡å™¨åœ°å€ï¼Œè®©æ¥å£æä¾›è€…æ›´çµæ´»åœ°æ¥å…¥ç³»ç»Ÿã€‚
å°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ä¹‹å‰ï¼Œè¦å¯¹æ¥å£è¿›è¡Œæ ¡éªŒï¼ˆæ¯”å¦‚æ£€æŸ¥ä»–çš„åœ°å€æ˜¯å¦éµå¾ªè§„åˆ™ï¼Œæµ‹è¯•è°ƒç”¨ï¼‰ï¼Œä¿è¯ä»–æ˜¯æ­£å¸¸çš„ã€‚
å°†æ¥å£ä¿¡æ¯å†™å…¥æ•°æ®åº“ä¹‹å‰éµå¾ªå’±ä»¬çš„è¦æ±‚ï¼ˆå¹¶ä¸”ä½¿ç”¨å’±ä»¬çš„ sdkï¼‰ï¼Œ
åœ¨æ¥å…¥æ—¶ï¼Œå¹³å°éœ€è¦æµ‹è¯•è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œä¿è¯ä»–æ˜¯æ­£å¸¸çš„ã€‚
 3. ç½‘å…³æ ¡éªŒæ˜¯å¦è¿˜æœ‰è°ƒç”¨æ¬¡æ•° 
éœ€è¦è€ƒè™‘å¹¶å‘é—®é¢˜ï¼Œé˜²æ­¢ç¬é—´è°ƒç”¨è¶…é¢ã€‚
 4. ç½‘å…³ä¼˜åŒ– 
æ¯”å¦‚å¢åŠ é™æµ / é™çº§ä¿æŠ¤ï¼Œæé«˜æ€§èƒ½ç­‰ã€‚è¿˜å¯ä»¥è€ƒè™‘æ­é… Nginx ç½‘å…³ä½¿ç”¨ã€‚
 5. åŠŸèƒ½å¢å¼º 
å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¯·æ±‚å¤´æˆ–è€…æ¥å£ç±»å‹æ¥è®¾è®¡å‰ç«¯ç•Œé¢å’Œè¡¨å•ï¼Œä¾¿äºç”¨æˆ·è°ƒç”¨ï¼Œè·å¾—æ›´å¥½çš„ä½“éªŒã€‚
å¯ä»¥å‚è€ƒ swaggerã€postmanã€knife4j çš„é¡µé¢ã€‚