# name: Deploy # å·¥ä½œæµåç§°
# on:
#   push: # push äº‹ä»¶è§¦å‘å·¥ä½œæµ
#     branches:
#       - hexoBlog # åªæœ‰åœ¨ hexoBlog åˆ†æ”¯æ¨é€æ—¶è§¦å‘å·¥ä½œæµ
# jobs:
#   build: # job1 id
#     runs-on: ubuntu-latest # è¿è¡Œç¯å¢ƒä¸ºæœ€æ–°ç‰ˆ Ubuntu
#     name: Deploy blog
#     steps:
#       - name: Checkout # æ­¥éª¤1ï¼šè·å–æºç 
#         uses: actions/checkout@v2 # ä½¿ç”¨ actions/checkout@v2

#       - name: Cache node modules # æ­¥éª¤2ï¼šç¼“å­˜ node_modules
#         uses: actions/cache@v2
#         with:
#           path: node_modules
#           key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
name: Build and Deploy
on: [push]
permissions:
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3
        
      - name: Install Hexo CLI  
        run: npm install -g hexo-cli@4.3.0
        env:  
          CI: false

      - name: Install Dependencies # æ­¥éª¤3ï¼šå®‰è£…ä¾èµ–
        if: steps.cache.outputs.cache-hit != 'true'
        run: npm run build
        env:
          CI: false
          
      - name: Deploy ğŸš€ # æ­¥éª¤4ï¼šéƒ¨ç½²
        # uses: JamesIves/github-pages-deploy-action@releases/v3
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          BRANCH: master # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
          FOLDER: public # éƒ¨ç½² public æ–‡ä»¶å¤¹